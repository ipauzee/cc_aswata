/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * ccasw_ticket.java
 *
 * Created on Feb 15, 2010, 6:11:22 PM
 */

package cc_aswata;

import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.*;
import javax.swing.JTextField;
import java.awt.*;
import java.awt.Event.*;
import java.sql.*;
import javax.sun.database.JavaConnector;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import java.io.*;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.Calendar;
import java.util.Iterator;
import java.util.List;
import java.util.ArrayList;
import java.net.*;
import java.text.SimpleDateFormat;

/**
 *
 * @author jsm
 */
public class ccasw_ticket extends javax.swing.JFrame {

    public static int id;
    public static int contid;
    public static int coun;
    public static int no1;
    public static int ticno;
    public static int submit;
    public static boolean newtic=true,claimReg=false;
    public static boolean caltic=false;
    public static String strnospNow="";
    public static int ass = -1;
    private static boolean raction=false,raction1=false,raction2=false,raction3=false;
    String s;
    String opdt;
    String optm;
    public static String deptid;
    String CatDetId,CatDetId1;
    String usrlvl;

    public static int sla=0;
    public static int statuss;
    private static int GT;
    private static int GS;
    private static int STORING;
    private static int OTHERS;
    private static int gtyes;
    private static int gsyes;
    private static int storingyes;
    private static int othersyes;
    private static String replacement;
    private static String rnarasi="";
    private static String rnarasi1="";
    private static String note;
    public static String strKategoryDetail="",strKategoryReason="",strKategory="",strSubKategoryDetail="",strDepartment="";
//    private String note;
    /** Creates new form ccasw_ticket */
    public ccasw_ticket() {
        initComponents();
        setSize(1022,650);
//        tabdet.setEnabledAt(5, false);
        showDept();showProd();
        showCategory();
        showType();showMedia();showSource();
        optm();
        opdt();
//        generateNoTrans();
        id=-1;
        catdetailupadate=false;newtic=true;
        catfinalupadate=false;claimReg=false;
//        submit=0;
//        klik2();
    }


     private ccasw_History Hic;
    public ccasw_ticket(ccasw_History hic){
        this();
        this.Hic=hic;
    }
    private ccasw_info inf;
    public ccasw_ticket(ccasw_info ifo){
        this();
        this.inf=ifo;
    }
    private ccasw_Search_customer Src;
    public ccasw_ticket(ccasw_Search_customer src){
        this();
        this.Src=src;
    }
    public static ContactCenterASWATA CCanj;
    public ccasw_ticket(ContactCenterASWATA ccanj){
        this();
        this.CCanj=ccanj;
    }
    private ccasw_login Log;
    public ccasw_ticket(ccasw_login log){
        this();
        this.Log=log;
    }
    public static ccasw_InBoundCall Inc;
    public ccasw_ticket(ccasw_InBoundCall inc){
        this();
        this.Inc=inc;
    }
    public static ccasw_OutBound Obc;
    public ccasw_ticket(ccasw_OutBound obc){
        this();
        this.Obc=obc;
    }
    private ccasw_Media Med;
    public ccasw_ticket(ccasw_Media med){
        this();
        this.Med=med;
    }
    private ccasw_SMS Sms;
    public ccasw_ticket(ccasw_SMS sms){
        this();
        this.Sms=sms;
    }
    private ccasw_EMail Mail;
    public ccasw_ticket(ccasw_EMail mail){
        this();
        this.Mail=mail;
    }
    private ccasw_FAX1 Fax;
    public ccasw_ticket(ccasw_FAX1 fax){
        this();
        this.Fax=fax;
    }
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel5 = new javax.swing.JPanel();
        jLabel13 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        txtTowMail = new javax.swing.JTextField();
        txtTowPho = new javax.swing.JTextField();
        txtTowName = new javax.swing.JTextField();
        jLabel26 = new javax.swing.JLabel();
        txtTowCode = new javax.swing.JTextField();
        jPanel10 = new javax.swing.JPanel();
        jLabel15 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        txtMV7 = new javax.swing.JTextField();
        txtMV3 = new javax.swing.JTextField();
        txtMV2 = new javax.swing.JTextField();
        jLabel27 = new javax.swing.JLabel();
        txtMV1 = new javax.swing.JTextField();
        jLabel35 = new javax.swing.JLabel();
        jLabel36 = new javax.swing.JLabel();
        jLabel37 = new javax.swing.JLabel();
        txtMV4 = new javax.swing.JTextField();
        txtMV5 = new javax.swing.JTextField();
        txtMV6 = new javax.swing.JTextField();
        jPanel11 = new javax.swing.JPanel();
        jLabel17 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        txtcsomail2 = new javax.swing.JTextField();
        txtcsopho2 = new javax.swing.JTextField();
        txtFire2 = new javax.swing.JTextField();
        jLabel28 = new javax.swing.JLabel();
        txtFire1 = new javax.swing.JTextField();
        jLabel38 = new javax.swing.JLabel();
        jLabel39 = new javax.swing.JLabel();
        txtcsomail8 = new javax.swing.JTextField();
        txtcsomail9 = new javax.swing.JTextField();
        jLabel24 = new javax.swing.JLabel();
        jLabel40 = new javax.swing.JLabel();
        jScrollPane2 = new javax.swing.JScrollPane();
        jPanel12 = new javax.swing.JPanel();
        jLabel19 = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jLabel29 = new javax.swing.JLabel();
        txtcsomail3 = new javax.swing.JTextField();
        txtcsopho3 = new javax.swing.JTextField();
        txtcso3 = new javax.swing.JTextField();
        jLabel30 = new javax.swing.JLabel();
        txtcsocode3 = new javax.swing.JTextField();
        jLabel41 = new javax.swing.JLabel();
        jLabel42 = new javax.swing.JLabel();
        jLabel43 = new javax.swing.JLabel();
        jLabel44 = new javax.swing.JLabel();
        jLabel45 = new javax.swing.JLabel();
        jLabel46 = new javax.swing.JLabel();
        jLabel47 = new javax.swing.JLabel();
        jLabel48 = new javax.swing.JLabel();
        jLabel49 = new javax.swing.JLabel();
        txtcsopho5 = new javax.swing.JTextField();
        txtcsomail10 = new javax.swing.JTextField();
        txtcsopho6 = new javax.swing.JTextField();
        txtcsomail11 = new javax.swing.JTextField();
        txtcsomail12 = new javax.swing.JTextField();
        txtcsomail13 = new javax.swing.JTextField();
        txtcsomail14 = new javax.swing.JTextField();
        jPanel13 = new javax.swing.JPanel();
        jLabel31 = new javax.swing.JLabel();
        jLabel32 = new javax.swing.JLabel();
        jLabel33 = new javax.swing.JLabel();
        txtcsomail4 = new javax.swing.JTextField();
        txtcsopho4 = new javax.swing.JTextField();
        txtcso4 = new javax.swing.JTextField();
        jLabel34 = new javax.swing.JLabel();
        txtcsocode4 = new javax.swing.JTextField();
        jScrollPane5 = new javax.swing.JScrollPane();
        jPanel7 = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        txtnotic = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        cbCategory = new javax.swing.JComboBox();
        cbprior = new javax.swing.JComboBox();
        cbDept = new javax.swing.JComboBox();
        btnreset = new javax.swing.JButton();
        tabdet = new javax.swing.JTabbedPane();
        jPanel4 = new javax.swing.JPanel();
        jLabel22 = new javax.swing.JLabel();
        btnsrch3 = new javax.swing.JButton();
        btnsrch1 = new javax.swing.JButton();
        btnsrchcus = new javax.swing.JButton();
        txtNoPolis = new javax.swing.JTextField();
        txtcusnam = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        txtcusfax = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        txtCellPho = new javax.swing.JTextField();
        jLabel21 = new javax.swing.JLabel();
        jScrollPane6 = new javax.swing.JScrollPane();
        txtcustadd = new javax.swing.JTextArea();
        jLabel9 = new javax.swing.JLabel();
        txtEmail = new javax.swing.JTextField();
        jLabel11 = new javax.swing.JLabel();
        cbSex = new javax.swing.JComboBox();
        jLabel12 = new javax.swing.JLabel();
        txtWorkPho = new javax.swing.JTextField();
        txtClaimNo = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        btnViewClaim = new javax.swing.JButton();
        btnViewPolis = new javax.swing.JButton();
        btncall = new javax.swing.JButton();
        btnfax = new javax.swing.JButton();
        btnmail = new javax.swing.JButton();
        btnsms = new javax.swing.JButton();
        jLabel54 = new javax.swing.JLabel();
        jLabel56 = new javax.swing.JLabel();
        cbTicketType = new javax.swing.JComboBox();
        jLabel57 = new javax.swing.JLabel();
        cbCatDetail = new javax.swing.JComboBox();
        jLabel81 = new javax.swing.JLabel();
        cbSourceTic = new javax.swing.JComboBox();
        jLabel82 = new javax.swing.JLabel();
        cbMediaTic = new javax.swing.JComboBox();
        cbCatDetail1 = new javax.swing.JComboBox();
        jLabel58 = new javax.swing.JLabel();
        cbProd = new javax.swing.JComboBox();
        jLabel59 = new javax.swing.JLabel();
        cbCatDetail2 = new javax.swing.JComboBox();
        jPanel6 = new javax.swing.JPanel();
        btncreate = new javax.swing.JButton();
        btnhist = new javax.swing.JButton();
        cksubmit = new javax.swing.JCheckBox();
        btnhist1 = new javax.swing.JButton();
        jPanel8 = new javax.swing.JPanel();
        btncanc = new javax.swing.JButton();
        jPanel9 = new javax.swing.JPanel();
        btnclosed = new javax.swing.JButton();
        btnReOpen = new javax.swing.JButton();
        jScrollPane4 = new javax.swing.JScrollPane();
        txtlastnote = new javax.swing.JTextArea();
        jLabel51 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        txtdetails = new javax.swing.JTextArea();
        jLabel52 = new javax.swing.JLabel();
        jLabel53 = new javax.swing.JLabel();
        jScrollPane11 = new javax.swing.JScrollPane();
        txtnote = new javax.swing.JTextArea();

        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
        setTitle("Ticket");
        setBackground(new java.awt.Color(204, 204, 255));
        setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        setResizable(false);
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowClosed(java.awt.event.WindowEvent evt) {
                formWindowClosed(evt);
            }
        });
        getContentPane().setLayout(null);

        jPanel5.setBackground(new java.awt.Color(255, 255, 255));
        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel5.setLayout(null);

        jLabel13.setFont(jLabel13.getFont().deriveFont((float)11));
        jLabel13.setText("Towing Name :"); // NOI18N
        jPanel5.add(jLabel13);
        jLabel13.setBounds(10, 30, 100, 20);

        jLabel14.setFont(jLabel14.getFont().deriveFont((float)11));
        jLabel14.setText("Towing Phone :"); // NOI18N
        jPanel5.add(jLabel14);
        jLabel14.setBounds(10, 50, 100, 20);

        jLabel20.setFont(jLabel20.getFont().deriveFont((float)11));
        jLabel20.setText("Towing email to :"); // NOI18N
        jPanel5.add(jLabel20);
        jLabel20.setBounds(10, 70, 100, 20);

        txtTowMail.setFont(txtTowMail.getFont().deriveFont((float)11));
        jPanel5.add(txtTowMail);
        txtTowMail.setBounds(110, 70, 360, 24);

        txtTowPho.setFont(txtTowPho.getFont().deriveFont((float)11));
        jPanel5.add(txtTowPho);
        txtTowPho.setBounds(110, 50, 360, 24);

        txtTowName.setFont(txtTowName.getFont().deriveFont((float)11));
        jPanel5.add(txtTowName);
        txtTowName.setBounds(110, 30, 360, 24);

        jLabel26.setFont(jLabel26.getFont().deriveFont((float)11));
        jLabel26.setText("Towing Code :"); // NOI18N
        jPanel5.add(jLabel26);
        jLabel26.setBounds(10, 10, 100, 20);

        txtTowCode.setFont(txtTowCode.getFont().deriveFont((float)11));
        jPanel5.add(txtTowCode);
        txtTowCode.setBounds(110, 10, 360, 24);

        jTabbedPane1.addTab("Towing", jPanel5);

        jPanel10.setBackground(new java.awt.Color(255, 255, 255));
        jPanel10.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel10.setLayout(null);

        jLabel15.setFont(jLabel15.getFont().deriveFont((float)11));
        jLabel15.setText("Luas jaminan (Rate, Deductible) :"); // NOI18N
        jPanel10.add(jLabel15);
        jLabel15.setBounds(10, 30, 160, 20);

        jLabel16.setFont(jLabel16.getFont().deriveFont((float)11));
        jLabel16.setText("Merk, Model dan Type :"); // NOI18N
        jPanel10.add(jLabel16);
        jLabel16.setBounds(10, 50, 150, 20);

        jLabel23.setFont(jLabel23.getFont().deriveFont((float)11));
        jLabel23.setText("Harga Pertanggungan :"); // NOI18N
        jPanel10.add(jLabel23);
        jLabel23.setBounds(10, 130, 150, 20);

        txtMV7.setFont(txtMV7.getFont().deriveFont((float)11));
        jPanel10.add(txtMV7);
        txtMV7.setBounds(180, 130, 330, 24);

        txtMV3.setFont(txtMV3.getFont().deriveFont((float)11));
        jPanel10.add(txtMV3);
        txtMV3.setBounds(180, 50, 330, 24);

        txtMV2.setFont(txtMV2.getFont().deriveFont((float)11));
        jPanel10.add(txtMV2);
        txtMV2.setBounds(180, 30, 330, 24);

        jLabel27.setFont(jLabel27.getFont().deriveFont((float)11));
        jLabel27.setText("Jangka waktu pertanggungan :"); // NOI18N
        jPanel10.add(jLabel27);
        jLabel27.setBounds(10, 10, 150, 20);

        txtMV1.setFont(txtMV1.getFont().deriveFont((float)11));
        jPanel10.add(txtMV1);
        txtMV1.setBounds(180, 10, 330, 24);

        jLabel35.setFont(jLabel35.getFont().deriveFont((float)11));
        jLabel35.setText("Nomor Polisi :"); // NOI18N
        jPanel10.add(jLabel35);
        jLabel35.setBounds(10, 70, 150, 20);

        jLabel36.setFont(jLabel36.getFont().deriveFont((float)11));
        jLabel36.setText("Nomor Rangka / Nomor Mesin :"); // NOI18N
        jPanel10.add(jLabel36);
        jLabel36.setBounds(10, 90, 150, 20);

        jLabel37.setFont(jLabel37.getFont().deriveFont((float)11));
        jLabel37.setText("Tahun Pembuatan / Warrna :"); // NOI18N
        jPanel10.add(jLabel37);
        jLabel37.setBounds(10, 110, 150, 20);

        txtMV4.setFont(txtMV4.getFont().deriveFont((float)11));
        jPanel10.add(txtMV4);
        txtMV4.setBounds(180, 70, 330, 24);

        txtMV5.setFont(txtMV5.getFont().deriveFont((float)11));
        jPanel10.add(txtMV5);
        txtMV5.setBounds(180, 90, 330, 24);

        txtMV6.setFont(txtMV6.getFont().deriveFont((float)11));
        jPanel10.add(txtMV6);
        txtMV6.setBounds(180, 110, 330, 24);

        jTabbedPane1.addTab("COB Motor Vehicle", jPanel10);

        jPanel11.setBackground(new java.awt.Color(255, 255, 255));
        jPanel11.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel11.setLayout(null);

        jLabel17.setFont(jLabel17.getFont().deriveFont((float)11));
        jLabel17.setText("Construction calss :"); // NOI18N
        jPanel11.add(jLabel17);
        jLabel17.setBounds(10, 70, 160, 20);

        jLabel18.setFont(jLabel18.getFont().deriveFont((float)11));
        jLabel18.setText("Kode Okupasi / Okupasi Bangunan :"); // NOI18N
        jPanel11.add(jLabel18);
        jLabel18.setBounds(20, 140, 180, 20);

        txtcsomail2.setFont(txtcsomail2.getFont().deriveFont((float)11));
        jPanel11.add(txtcsomail2);
        txtcsomail2.setBounds(200, 140, 310, 24);

        txtcsopho2.setFont(txtcsopho2.getFont().deriveFont((float)11));
        jPanel11.add(txtcsopho2);
        txtcsopho2.setBounds(180, 50, 330, 24);

        txtFire2.setFont(txtFire2.getFont().deriveFont((float)11));
        jPanel11.add(txtFire2);
        txtFire2.setBounds(180, 30, 330, 24);

        jLabel28.setFont(jLabel28.getFont().deriveFont((float)11));
        jLabel28.setText("Lokasi pertanggungan :"); // NOI18N
        jPanel11.add(jLabel28);
        jLabel28.setBounds(10, 50, 160, 20);

        txtFire1.setFont(txtFire1.getFont().deriveFont((float)11));
        jPanel11.add(txtFire1);
        txtFire1.setBounds(180, 10, 330, 24);

        jLabel38.setFont(jLabel38.getFont().deriveFont((float)11));
        jLabel38.setText("Jangka waktu pertanggungan :"); // NOI18N
        jPanel11.add(jLabel38);
        jLabel38.setBounds(10, 10, 150, 20);

        jLabel39.setFont(jLabel39.getFont().deriveFont((float)11));
        jLabel39.setText("Luas jaminan (Rate, Deductible) :"); // NOI18N
        jPanel11.add(jLabel39);
        jLabel39.setBounds(10, 30, 160, 20);

        txtcsomail8.setFont(txtcsomail8.getFont().deriveFont((float)11));
        jPanel11.add(txtcsomail8);
        txtcsomail8.setBounds(180, 70, 330, 24);

        txtcsomail9.setFont(txtcsomail9.getFont().deriveFont((float)11));
        jPanel11.add(txtcsomail9);
        txtcsomail9.setBounds(180, 120, 330, 24);

        jLabel24.setFont(jLabel24.getFont().deriveFont((float)11));
        jLabel24.setText("Harga Pertanggungan :"); // NOI18N
        jPanel11.add(jLabel24);
        jLabel24.setBounds(20, 120, 150, 20);

        jLabel40.setFont(jLabel40.getFont().deriveFont((float)11));
        jLabel40.setText("Interest Insured (Detail Risk) "); // NOI18N
        jPanel11.add(jLabel40);
        jLabel40.setBounds(10, 100, 160, 20);

        jTabbedPane1.addTab("COB Fire", jPanel11);

        jPanel12.setBackground(new java.awt.Color(255, 255, 255));
        jPanel12.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel12.setPreferredSize(new java.awt.Dimension(520, 320));
        jPanel12.setLayout(null);

        jLabel19.setFont(jLabel19.getFont().deriveFont((float)11));
        jLabel19.setText("Nomor kapal / pesawat :"); // NOI18N
        jPanel12.add(jLabel19);
        jLabel19.setBounds(10, 70, 160, 20);

        jLabel25.setFont(jLabel25.getFont().deriveFont((float)11));
        jLabel25.setText("Dokumen pembelian dan pengiriman :"); // NOI18N
        jPanel12.add(jLabel25);
        jLabel25.setBounds(10, 170, 180, 20);

        jLabel29.setFont(jLabel29.getFont().deriveFont((float)11));
        jLabel29.setText("Pelabuhan Tujuan :"); // NOI18N
        jPanel12.add(jLabel29);
        jLabel29.setBounds(30, 140, 140, 20);

        txtcsomail3.setFont(txtcsomail3.getFont().deriveFont((float)11));
        jPanel12.add(txtcsomail3);
        txtcsomail3.setBounds(180, 70, 330, 24);

        txtcsopho3.setFont(txtcsopho3.getFont().deriveFont((float)11));
        jPanel12.add(txtcsopho3);
        txtcsopho3.setBounds(180, 50, 330, 24);

        txtcso3.setFont(txtcso3.getFont().deriveFont((float)11));
        jPanel12.add(txtcso3);
        txtcso3.setBounds(180, 30, 330, 24);

        jLabel30.setFont(jLabel30.getFont().deriveFont((float)11));
        jLabel30.setText("Nama kapal / pesawat :"); // NOI18N
        jPanel12.add(jLabel30);
        jLabel30.setBounds(10, 50, 160, 20);

        txtcsocode3.setFont(txtcsocode3.getFont().deriveFont((float)11));
        jPanel12.add(txtcsocode3);
        txtcsocode3.setBounds(180, 10, 330, 24);

        jLabel41.setFont(jLabel41.getFont().deriveFont((float)11));
        jLabel41.setText("Jangka waktu pertanggungan :"); // NOI18N
        jPanel12.add(jLabel41);
        jLabel41.setBounds(10, 10, 150, 20);

        jLabel42.setFont(jLabel42.getFont().deriveFont((float)11));
        jLabel42.setText("Luas jaminan (Rate, Deductible) :"); // NOI18N
        jPanel12.add(jLabel42);
        jLabel42.setBounds(10, 30, 160, 20);

        jLabel43.setFont(jLabel43.getFont().deriveFont((float)11));
        jLabel43.setText("Pelabuhan Asal :"); // NOI18N
        jPanel12.add(jLabel43);
        jLabel43.setBounds(30, 120, 140, 20);

        jLabel44.setFont(jLabel44.getFont().deriveFont((float)11));
        jLabel44.setText("List of imterest and sum insured "); // NOI18N
        jPanel12.add(jLabel44);
        jLabel44.setBounds(10, 200, 160, 20);

        jLabel45.setFont(jLabel45.getFont().deriveFont((float)11));
        jLabel45.setText("Tanggal keberangkatan "); // NOI18N
        jPanel12.add(jLabel45);
        jLabel45.setBounds(10, 100, 160, 20);

        jLabel46.setFont(jLabel46.getFont().deriveFont((float)11));
        jLabel46.setText("Nama barang :"); // NOI18N
        jPanel12.add(jLabel46);
        jLabel46.setBounds(30, 220, 140, 20);

        jLabel47.setFont(jLabel47.getFont().deriveFont((float)11));
        jLabel47.setText("Nilai pertanggungan :"); // NOI18N
        jPanel12.add(jLabel47);
        jLabel47.setBounds(30, 260, 140, 20);

        jLabel48.setFont(jLabel48.getFont().deriveFont((float)11));
        jLabel48.setText("Jumlah barang :"); // NOI18N
        jPanel12.add(jLabel48);
        jLabel48.setBounds(30, 240, 140, 20);

        jLabel49.setFont(jLabel49.getFont().deriveFont((float)11));
        jLabel49.setText("Consignee / Beneficiary :"); // NOI18N
        jPanel12.add(jLabel49);
        jLabel49.setBounds(10, 290, 180, 20);

        txtcsopho5.setFont(txtcsopho5.getFont().deriveFont((float)11));
        jPanel12.add(txtcsopho5);
        txtcsopho5.setBounds(180, 120, 330, 24);

        txtcsomail10.setFont(txtcsomail10.getFont().deriveFont((float)11));
        jPanel12.add(txtcsomail10);
        txtcsomail10.setBounds(180, 140, 330, 24);

        txtcsopho6.setFont(txtcsopho6.getFont().deriveFont((float)11));
        jPanel12.add(txtcsopho6);
        txtcsopho6.setBounds(190, 170, 320, 24);

        txtcsomail11.setFont(txtcsomail11.getFont().deriveFont((float)11));
        jPanel12.add(txtcsomail11);
        txtcsomail11.setBounds(180, 290, 330, 24);

        txtcsomail12.setFont(txtcsomail12.getFont().deriveFont((float)11));
        jPanel12.add(txtcsomail12);
        txtcsomail12.setBounds(180, 220, 330, 24);

        txtcsomail13.setFont(txtcsomail13.getFont().deriveFont((float)11));
        jPanel12.add(txtcsomail13);
        txtcsomail13.setBounds(180, 240, 330, 24);

        txtcsomail14.setFont(txtcsomail14.getFont().deriveFont((float)11));
        jPanel12.add(txtcsomail14);
        txtcsomail14.setBounds(180, 260, 330, 24);

        jScrollPane2.setViewportView(jPanel12);

        jTabbedPane1.addTab("COB Marine Cargo", jScrollPane2);

        jPanel13.setBackground(new java.awt.Color(255, 255, 255));
        jPanel13.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel13.setLayout(null);

        jLabel31.setFont(jLabel31.getFont().deriveFont((float)11));
        jLabel31.setText("Name Beneficiary:"); // NOI18N
        jPanel13.add(jLabel31);
        jLabel31.setBounds(10, 10, 150, 20);

        jLabel32.setFont(jLabel32.getFont().deriveFont((float)11));
        jLabel32.setText("Harga pertanggungan :"); // NOI18N
        jPanel13.add(jLabel32);
        jLabel32.setBounds(10, 50, 150, 20);

        jLabel33.setFont(jLabel33.getFont().deriveFont((float)11));
        jLabel33.setText("Ahli waris :"); // NOI18N
        jPanel13.add(jLabel33);
        jLabel33.setBounds(10, 70, 150, 20);

        txtcsomail4.setFont(txtcsomail4.getFont().deriveFont((float)11));
        jPanel13.add(txtcsomail4);
        txtcsomail4.setBounds(170, 70, 340, 24);

        txtcsopho4.setFont(txtcsopho4.getFont().deriveFont((float)11));
        jPanel13.add(txtcsopho4);
        txtcsopho4.setBounds(170, 50, 340, 24);

        txtcso4.setFont(txtcso4.getFont().deriveFont((float)11));
        jPanel13.add(txtcso4);
        txtcso4.setBounds(170, 30, 340, 24);

        jLabel34.setFont(jLabel34.getFont().deriveFont((float)11));
        jLabel34.setText("Luas Jaminan :"); // NOI18N
        jPanel13.add(jLabel34);
        jLabel34.setBounds(10, 30, 150, 20);

        txtcsocode4.setFont(txtcsocode4.getFont().deriveFont((float)11));
        jPanel13.add(txtcsocode4);
        txtcsocode4.setBounds(170, 10, 340, 24);

        jTabbedPane1.addTab("COB Personal Accidental", jPanel13);

        getContentPane().add(jTabbedPane1);
        jTabbedPane1.setBounds(0, 0, 0, 0);

        jPanel7.setBackground(new java.awt.Color(255, 255, 255));
        jPanel7.setLayout(null);

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));
        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "<<OPEN NEW TICKET>>", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 10))); // NOI18N
        jPanel1.setFont(jPanel1.getFont().deriveFont((float)11));
        jPanel1.setLayout(null);

        jLabel1.setFont(jLabel1.getFont().deriveFont((float)11));
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("Ticket No. :"); // NOI18N
        jPanel1.add(jLabel1);
        jLabel1.setBounds(300, 20, 80, 20);

        txtnotic.setEditable(false);
        txtnotic.setFont(txtnotic.getFont().deriveFont(txtnotic.getFont().getStyle() | java.awt.Font.BOLD, 11));
        txtnotic.setEnabled(false);
        jPanel1.add(txtnotic);
        txtnotic.setBounds(380, 20, 150, 24);

        jLabel2.setFont(jLabel2.getFont().deriveFont((float)11));
        jLabel2.setText("*Category :"); // NOI18N
        jPanel1.add(jLabel2);
        jLabel2.setBounds(30, 80, 100, 20);

        jLabel3.setFont(jLabel3.getFont().deriveFont((float)11));
        jLabel3.setText("*Cat. Detail :"); // NOI18N
        jPanel1.add(jLabel3);
        jLabel3.setBounds(30, 100, 100, 20);

        jLabel6.setFont(jLabel6.getFont().deriveFont((float)11));
        jLabel6.setText("*Prority :"); // NOI18N
        jPanel1.add(jLabel6);
        jLabel6.setBounds(30, 20, 100, 20);

        cbCategory.setFont(cbCategory.getFont().deriveFont((float)11));
        cbCategory.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbCategoryActionPerformed(evt);
            }
        });
        jPanel1.add(cbCategory);
        cbCategory.setBounds(130, 80, 400, 24);

        cbprior.setFont(cbprior.getFont().deriveFont(cbprior.getFont().getStyle() | java.awt.Font.BOLD, 11));
        cbprior.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "NORMAL", "URGENT" }));
        jPanel1.add(cbprior);
        cbprior.setBounds(130, 20, 170, 24);

        cbDept.setFont(cbDept.getFont().deriveFont((float)11));
        cbDept.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseExited(java.awt.event.MouseEvent evt) {
                cbDeptMouseExited(evt);
            }
        });
        cbDept.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbDeptActionPerformed(evt);
            }
        });
        cbDept.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                cbDeptFocusLost(evt);
            }
        });
        jPanel1.add(cbDept);
        cbDept.setBounds(130, 180, 340, 24);

        btnreset.setFont(btnreset.getFont().deriveFont(btnreset.getFont().getStyle() | java.awt.Font.BOLD, 10));
        btnreset.setText("Reset");
        btnreset.setIconTextGap(0);
        btnreset.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnresetActionPerformed(evt);
            }
        });
        jPanel1.add(btnreset);
        btnreset.setBounds(470, 180, 60, 24);

        tabdet.setTabLayoutPolicy(javax.swing.JTabbedPane.SCROLL_TAB_LAYOUT);
        tabdet.setFont(tabdet.getFont().deriveFont((float)10));

        jPanel4.setBackground(new java.awt.Color(255, 255, 255));
        jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel4.setLayout(null);

        jLabel22.setBackground(new java.awt.Color(102, 102, 255));
        jLabel22.setFont(jLabel22.getFont().deriveFont((float)11));
        jLabel22.setText("  No. Polis :"); // NOI18N
        jPanel4.add(jLabel22);
        jLabel22.setBounds(10, 10, 100, 20);

        btnsrch3.setFont(new java.awt.Font("Calibri", 0, 12)); // NOI18N
        btnsrch3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/1245117595_001_37.png"))); // NOI18N
        btnsrch3.setToolTipText("Search Policy");
        btnsrch3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsrch3ActionPerformed(evt);
            }
        });
        jPanel4.add(btnsrch3);
        btnsrch3.setBounds(490, 10, 24, 24);

        btnsrch1.setFont(new java.awt.Font("Calibri", 0, 12)); // NOI18N
        btnsrch1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/1245117595_001_37.png"))); // NOI18N
        btnsrch1.setToolTipText("Search Claim Registration");
        btnsrch1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsrch1ActionPerformed(evt);
            }
        });
        jPanel4.add(btnsrch1);
        btnsrch1.setBounds(490, 30, 24, 24);

        btnsrchcus.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        btnsrchcus.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/1245117595_001_37.png"))); // NOI18N
        btnsrchcus.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnsrchcusMouseClicked(evt);
            }
        });
        btnsrchcus.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsrchcusActionPerformed(evt);
            }
        });
        jPanel4.add(btnsrchcus);
        btnsrchcus.setBounds(490, 54, 24, 20);

        txtNoPolis.setFont(txtNoPolis.getFont().deriveFont((float)11));
        txtNoPolis.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                txtNoPolisCaretUpdate(evt);
            }
        });
        jPanel4.add(txtNoPolis);
        txtNoPolis.setBounds(110, 10, 310, 24);

        txtcusnam.setFont(txtcusnam.getFont().deriveFont((float)11));
        jPanel4.add(txtcusnam);
        txtcusnam.setBounds(110, 50, 380, 24);

        jLabel7.setBackground(new java.awt.Color(102, 102, 255));
        jLabel7.setFont(jLabel7.getFont().deriveFont((float)11));
        jLabel7.setText("*Name :"); // NOI18N
        jPanel4.add(jLabel7);
        jLabel7.setBounds(10, 50, 100, 20);

        jLabel8.setBackground(new java.awt.Color(102, 102, 255));
        jLabel8.setFont(jLabel8.getFont().deriveFont((float)11));
        jLabel8.setText("  Work Phone :"); // NOI18N
        jPanel4.add(jLabel8);
        jLabel8.setBounds(10, 90, 100, 20);

        txtcusfax.setFont(txtcusfax.getFont().deriveFont((float)11));
        jPanel4.add(txtcusfax);
        txtcusfax.setBounds(360, 90, 150, 24);

        jLabel10.setBackground(new java.awt.Color(102, 102, 255));
        jLabel10.setFont(jLabel10.getFont().deriveFont((float)11));
        jLabel10.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel10.setText("Cell Phone :"); // NOI18N
        jPanel4.add(jLabel10);
        jLabel10.setBounds(260, 70, 100, 20);

        txtCellPho.setFont(txtCellPho.getFont().deriveFont((float)11));
        jPanel4.add(txtCellPho);
        txtCellPho.setBounds(360, 70, 150, 24);

        jLabel21.setBackground(new java.awt.Color(102, 102, 255));
        jLabel21.setFont(jLabel21.getFont().deriveFont((float)11));
        jLabel21.setText("  Address :"); // NOI18N
        jPanel4.add(jLabel21);
        jLabel21.setBounds(10, 130, 100, 20);

        txtcustadd.setColumns(20);
        txtcustadd.setFont(txtcustadd.getFont().deriveFont((float)11));
        txtcustadd.setLineWrap(true);
        txtcustadd.setRows(5);
        jScrollPane6.setViewportView(txtcustadd);

        jPanel4.add(jScrollPane6);
        jScrollPane6.setBounds(110, 130, 400, 70);

        jLabel9.setBackground(new java.awt.Color(102, 102, 255));
        jLabel9.setFont(jLabel9.getFont().deriveFont((float)11));
        jLabel9.setText("  Email :"); // NOI18N
        jPanel4.add(jLabel9);
        jLabel9.setBounds(10, 110, 100, 20);

        txtEmail.setFont(txtEmail.getFont().deriveFont((float)11));
        txtEmail.setAutoscrolls(false);
        jPanel4.add(txtEmail);
        txtEmail.setBounds(110, 110, 400, 24);

        jLabel11.setBackground(new java.awt.Color(102, 102, 255));
        jLabel11.setFont(jLabel11.getFont().deriveFont((float)11));
        jLabel11.setText("  Sex :"); // NOI18N
        jPanel4.add(jLabel11);
        jLabel11.setBounds(10, 70, 100, 20);

        cbSex.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "MALE", "FEMALE" }));
        jPanel4.add(cbSex);
        cbSex.setBounds(110, 70, 150, 24);

        jLabel12.setBackground(new java.awt.Color(102, 102, 255));
        jLabel12.setFont(jLabel12.getFont().deriveFont((float)11));
        jLabel12.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel12.setText("Fax :"); // NOI18N
        jPanel4.add(jLabel12);
        jLabel12.setBounds(260, 90, 100, 20);

        txtWorkPho.setFont(txtWorkPho.getFont().deriveFont((float)11));
        jPanel4.add(txtWorkPho);
        txtWorkPho.setBounds(110, 90, 150, 24);

        txtClaimNo.setFont(txtClaimNo.getFont().deriveFont((float)11));
        txtClaimNo.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                txtClaimNoCaretUpdate(evt);
            }
        });
        jPanel4.add(txtClaimNo);
        txtClaimNo.setBounds(110, 30, 310, 25);

        jLabel5.setFont(jLabel5.getFont().deriveFont((float)11));
        jLabel5.setText("  Claim Reg. No. : ");
        jPanel4.add(jLabel5);
        jLabel5.setBounds(10, 30, 100, 20);

        btnViewClaim.setFont(btnViewClaim.getFont().deriveFont(btnViewClaim.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btnViewClaim.setText("view");
        btnViewClaim.setEnabled(false);
        btnViewClaim.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnViewClaimActionPerformed(evt);
            }
        });
        jPanel4.add(btnViewClaim);
        btnViewClaim.setBounds(420, 30, 70, 24);

        btnViewPolis.setFont(btnViewPolis.getFont().deriveFont(btnViewPolis.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btnViewPolis.setText("view");
        btnViewPolis.setEnabled(false);
        btnViewPolis.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnViewPolisActionPerformed(evt);
            }
        });
        jPanel4.add(btnViewPolis);
        btnViewPolis.setBounds(420, 10, 70, 24);

        tabdet.addTab("Customer", jPanel4);

        jPanel1.add(tabdet);
        tabdet.setBounds(10, 210, 540, 240);

        btncall.setFont(btncall.getFont().deriveFont(btncall.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btncall.setForeground(new java.awt.Color(0, 153, 51));
        btncall.setText("Call");
        btncall.setEnabled(false);
        btncall.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btncallActionPerformed(evt);
            }
        });
        jPanel1.add(btncall);
        btncall.setBounds(280, 450, 60, 25);

        btnfax.setFont(btnfax.getFont().deriveFont(btnfax.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btnfax.setForeground(new java.awt.Color(0, 153, 51));
        btnfax.setText("Fax");
        btnfax.setEnabled(false);
        btnfax.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnfaxActionPerformed(evt);
            }
        });
        jPanel1.add(btnfax);
        btnfax.setBounds(470, 450, 60, 25);

        btnmail.setFont(btnmail.getFont().deriveFont(btnmail.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btnmail.setForeground(new java.awt.Color(0, 153, 51));
        btnmail.setText("Email");
        btnmail.setEnabled(false);
        btnmail.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnmailActionPerformed(evt);
            }
        });
        jPanel1.add(btnmail);
        btnmail.setBounds(400, 450, 70, 25);

        btnsms.setFont(btnsms.getFont().deriveFont(btnsms.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btnsms.setForeground(new java.awt.Color(0, 153, 51));
        btnsms.setText("Sms");
        btnsms.setEnabled(false);
        btnsms.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsmsActionPerformed(evt);
            }
        });
        jPanel1.add(btnsms);
        btnsms.setBounds(340, 450, 60, 25);

        jLabel54.setFont(jLabel54.getFont().deriveFont((float)11));
        jLabel54.setText("*Department :"); // NOI18N
        jPanel1.add(jLabel54);
        jLabel54.setBounds(30, 180, 100, 20);

        jLabel56.setFont(jLabel56.getFont().deriveFont((float)11));
        jLabel56.setText("  Sub Cat. Detail :"); // NOI18N
        jPanel1.add(jLabel56);
        jLabel56.setBounds(30, 120, 100, 20);

        cbTicketType.setFont(cbTicketType.getFont().deriveFont((float)11));
        jPanel1.add(cbTicketType);
        cbTicketType.setBounds(130, 60, 400, 24);

        jLabel57.setFont(jLabel57.getFont().deriveFont((float)11));
        jLabel57.setText("*Ticket type :"); // NOI18N
        jPanel1.add(jLabel57);
        jLabel57.setBounds(30, 60, 100, 20);

        cbCatDetail.setFont(cbCatDetail.getFont().deriveFont((float)11));
        cbCatDetail.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbCatDetailActionPerformed(evt);
            }
        });
        jPanel1.add(cbCatDetail);
        cbCatDetail.setBounds(130, 100, 400, 24);

        jLabel81.setFont(jLabel81.getFont().deriveFont((float)11));
        jLabel81.setText("*Source Ticket :"); // NOI18N
        jPanel1.add(jLabel81);
        jLabel81.setBounds(30, 40, 100, 20);

        cbSourceTic.setFont(cbSourceTic.getFont().deriveFont(cbSourceTic.getFont().getStyle() | java.awt.Font.BOLD, 11));
        jPanel1.add(cbSourceTic);
        cbSourceTic.setBounds(130, 40, 170, 24);

        jLabel82.setFont(jLabel82.getFont().deriveFont((float)11));
        jLabel82.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel82.setText("Ticket Media :"); // NOI18N
        jPanel1.add(jLabel82);
        jLabel82.setBounds(300, 40, 80, 20);

        cbMediaTic.setFont(cbMediaTic.getFont().deriveFont(cbMediaTic.getFont().getStyle() | java.awt.Font.BOLD, 11));
        jPanel1.add(cbMediaTic);
        cbMediaTic.setBounds(380, 40, 150, 24);

        cbCatDetail1.setFont(cbCatDetail1.getFont().deriveFont((float)11));
        cbCatDetail1.setEnabled(false);
        cbCatDetail1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbCatDetail1ActionPerformed(evt);
            }
        });
        jPanel1.add(cbCatDetail1);
        cbCatDetail1.setBounds(130, 120, 400, 24);

        jLabel58.setFont(jLabel58.getFont().deriveFont((float)11));
        jLabel58.setText("*Related Product :"); // NOI18N
        jPanel1.add(jLabel58);
        jLabel58.setBounds(30, 160, 100, 20);

        cbProd.setFont(cbProd.getFont().deriveFont((float)11));
        cbProd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbProdActionPerformed(evt);
            }
        });
        jPanel1.add(cbProd);
        cbProd.setBounds(130, 160, 400, 24);

        jLabel59.setFont(jLabel59.getFont().deriveFont((float)11));
        jLabel59.setText("  Category Reason :"); // NOI18N
        jPanel1.add(jLabel59);
        jLabel59.setBounds(30, 140, 100, 20);

        cbCatDetail2.setFont(cbCatDetail2.getFont().deriveFont((float)11));
        cbCatDetail2.setEnabled(false);
        jPanel1.add(cbCatDetail2);
        cbCatDetail2.setBounds(130, 140, 400, 24);

        jPanel7.add(jPanel1);
        jPanel1.setBounds(10, 10, 560, 490);

        jPanel6.setBackground(new java.awt.Color(255, 255, 255));
        jPanel6.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Action", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 10))); // NOI18N
        jPanel6.setFont(jPanel6.getFont().deriveFont((float)11));
        jPanel6.setLayout(null);

        btncreate.setFont(btncreate.getFont().deriveFont(btncreate.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btncreate.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/1.jpg"))); // NOI18N
        btncreate.setText("Submit"); // NOI18N
        btncreate.setToolTipText("Create Ticket"); // NOI18N
        btncreate.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                btncreateMouseEntered(evt);
            }
        });
        btncreate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btncreateActionPerformed(evt);
            }
        });
        jPanel6.add(btncreate);
        btncreate.setBounds(10, 20, 113, 40);

        btnhist.setFont(btnhist.getFont().deriveFont(btnhist.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btnhist.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/hi.jpg"))); // NOI18N
        btnhist.setText("History"); // NOI18N
        btnhist.setToolTipText("History"); // NOI18N
        btnhist.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnhistMouseClicked(evt);
            }
        });
        btnhist.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnhistActionPerformed(evt);
            }
        });
        jPanel6.add(btnhist);
        btnhist.setBounds(200, 20, 110, 40);

        cksubmit.setBackground(new java.awt.Color(204, 204, 255));
        cksubmit.setFont(cksubmit.getFont().deriveFont(cksubmit.getFont().getStyle() | java.awt.Font.BOLD, 11));
        cksubmit.setSelected(true);
        cksubmit.setText("Submit");
        cksubmit.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                cksubmitMouseClicked(evt);
            }
        });
        jPanel6.add(cksubmit);
        cksubmit.setBounds(120, 20, 80, 20);

        btnhist1.setFont(btnhist1.getFont().deriveFont(btnhist1.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btnhist1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/z.jpg"))); // NOI18N
        btnhist1.setText("Media"); // NOI18N
        btnhist1.setToolTipText("History"); // NOI18N
        btnhist1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnhist1MouseClicked(evt);
            }
        });
        jPanel6.add(btnhist1);
        btnhist1.setBounds(310, 20, 110, 40);

        jPanel7.add(jPanel6);
        jPanel6.setBounds(580, 10, 430, 70);

        jPanel8.setBackground(new java.awt.Color(255, 255, 255));
        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Action", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 10))); // NOI18N
        jPanel8.setFont(jPanel8.getFont().deriveFont((float)11));
        jPanel8.setLayout(null);

        btncanc.setFont(btncanc.getFont().deriveFont(btncanc.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btncanc.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/exit.jpg"))); // NOI18N
        btncanc.setText("Exit"); // NOI18N
        btncanc.setToolTipText("EXIT"); // NOI18N
        btncanc.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btncancActionPerformed(evt);
            }
        });
        jPanel8.add(btncanc);
        btncanc.setBounds(20, 20, 90, 40);

        jPanel7.add(jPanel8);
        jPanel8.setBounds(870, 430, 130, 70);

        jPanel9.setBackground(new java.awt.Color(255, 255, 255));
        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Action", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 10))); // NOI18N
        jPanel9.setFont(jPanel9.getFont().deriveFont((float)11));
        jPanel9.setLayout(null);

        btnclosed.setFont(btnclosed.getFont().deriveFont(btnclosed.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btnclosed.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/comp.jpg"))); // NOI18N
        btnclosed.setText("Closed"); // NOI18N
        btnclosed.setToolTipText("Closed Ticket"); // NOI18N
        btnclosed.setEnabled(false);
        btnclosed.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnclosedActionPerformed(evt);
            }
        });
        jPanel9.add(btnclosed);
        btnclosed.setBounds(150, 20, 110, 40);

        btnReOpen.setFont(btnReOpen.getFont().deriveFont(btnReOpen.getFont().getStyle() | java.awt.Font.BOLD, 11));
        btnReOpen.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/REOPEN.png"))); // NOI18N
        btnReOpen.setText("Re-Open"); // NOI18N
        btnReOpen.setToolTipText("Cancel"); // NOI18N
        btnReOpen.setEnabled(false);
        btnReOpen.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnReOpenMouseClicked(evt);
            }
        });
        btnReOpen.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnReOpenActionPerformed(evt);
            }
        });
        jPanel9.add(btnReOpen);
        btnReOpen.setBounds(20, 20, 120, 40);

        jPanel7.add(jPanel9);
        jPanel9.setBounds(580, 430, 280, 70);

        txtlastnote.setColumns(20);
        txtlastnote.setEditable(false);
        txtlastnote.setFont(txtlastnote.getFont().deriveFont((float)11));
        txtlastnote.setLineWrap(true);
        txtlastnote.setRows(5);
        jScrollPane4.setViewportView(txtlastnote);

        jPanel7.add(jScrollPane4);
        jScrollPane4.setBounds(580, 240, 420, 190);

        jLabel51.setFont(jLabel51.getFont().deriveFont(jLabel51.getFont().getStyle() | java.awt.Font.BOLD, 10));
        jLabel51.setForeground(new java.awt.Color(51, 51, 255));
        jLabel51.setText("Details :");
        jPanel7.add(jLabel51);
        jLabel51.setBounds(580, 80, 60, 10);

        txtdetails.setColumns(20);
        txtdetails.setFont(txtdetails.getFont().deriveFont((float)11));
        txtdetails.setLineWrap(true);
        txtdetails.setRows(5);
        jScrollPane1.setViewportView(txtdetails);

        jPanel7.add(jScrollPane1);
        jScrollPane1.setBounds(580, 90, 420, 140);

        jLabel52.setFont(jLabel52.getFont().deriveFont(jLabel52.getFont().getStyle() | java.awt.Font.BOLD, 10));
        jLabel52.setForeground(new java.awt.Color(51, 51, 255));
        jLabel52.setText("Last Note :");
        jPanel7.add(jLabel52);
        jLabel52.setBounds(580, 230, 100, 10);

        jLabel53.setFont(jLabel53.getFont().deriveFont(jLabel53.getFont().getStyle() | java.awt.Font.BOLD, 10));
        jLabel53.setForeground(new java.awt.Color(51, 51, 255));
        jLabel53.setText("Note :");
        jPanel7.add(jLabel53);
        jLabel53.setBounds(20, 500, 40, 10);

        txtnote.setColumns(20);
        txtnote.setFont(txtnote.getFont().deriveFont((float)11));
        txtnote.setLineWrap(true);
        txtnote.setRows(5);
        jScrollPane11.setViewportView(txtnote);

        jPanel7.add(jScrollPane11);
        jScrollPane11.setBounds(20, 510, 980, 90);

        jScrollPane5.setViewportView(jPanel7);

        getContentPane().add(jScrollPane5);
        jScrollPane5.setBounds(0, 0, 1020, 620);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void cbDeptMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_cbDeptMouseExited
        // TODO add your handling code here:
//        showcategory();
    }//GEN-LAST:event_cbDeptMouseExited

    private void cbDeptFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_cbDeptFocusLost
        // TODO add your handling code here:
        
    }//GEN-LAST:event_cbDeptFocusLost


    private void btnhistMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnhistMouseClicked
        // TODO add your handling code here:
        ccasw_History hic = new ccasw_History();
        hic.setVisible(true);

        Hic.no=id;
        Hic.ticid=Integer.valueOf((String)txtnotic.getText());
        Hic.klik2();
    }//GEN-LAST:event_btnhistMouseClicked

    private void btncancActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btncancActionPerformed
        // TODO add your handling code here:
        dispose();
        CCanj.ticshow=false;
    }//GEN-LAST:event_btncancActionPerformed

    private void btnsrchcusMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnsrchcusMouseClicked
        // TODO add your handling code here:
        ccasw_Search_customer sc = new ccasw_Search_customer();
        sc.setVisible(true);
        sc.Form=1;
    }//GEN-LAST:event_btnsrchcusMouseClicked

    private void btncreateMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btncreateMouseEntered
        // TODO add your handling code here:
        if (txtcusnam.getText().equals("")){
            JOptionPane.showMessageDialog(null, "Customer Name cannot be empty !!", "TICKET",JOptionPane.WARNING_MESSAGE);
        }
    }//GEN-LAST:event_btncreateMouseEntered

    private void cksubmitMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_cksubmitMouseClicked
        // TODO add your handling code here:
        if(cksubmit.isSelected()==true){
            btnclosed.setEnabled(false);
            submit=1;
            btncreate.setText("Submit");
            
        }else{
            btnclosed.setEnabled(true);
            submit=0;
            if(newtic==true){
                btncreate.setText("Created");
            }else{
                btncreate.setText("Save");
            }
        }
    }//GEN-LAST:event_cksubmitMouseClicked

    private void btnReOpenMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnReOpenMouseClicked
        // TODO add your handling code here:
        
    }//GEN-LAST:event_btnReOpenMouseClicked

    private void cbCategoryActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbCategoryActionPerformed
        // TODO add your handling code here:
        if(raction==true){
            showDetailCategory();
            if(newtic==false){
                getdetiltic();
            }
        }
    }//GEN-LAST:event_cbCategoryActionPerformed

    private void formWindowClosed(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowClosed
        // TODO add your handling code here:
        btncall.setEnabled(false);
        btnfax.setEnabled(false);
        btnmail.setEnabled(false);
        btnsms.setEnabled(false);
        CCanj.ticshow=false;
//        try {
//            conn.close();
//        } catch (SQLException ex) {
//            System.err.println(ex.getMessage());
//        }
    }//GEN-LAST:event_formWindowClosed

    private void btnhist1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnhist1MouseClicked
        // TODO add your handling code here:
        ccasw_Media med = new ccasw_Media();
        med.setVisible(true);

        Med.no=id;
        Med.tno=txtnotic.getText();
        Med.tabelmedia();
    }//GEN-LAST:event_btnhist1MouseClicked

    private void btnfaxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnfaxActionPerformed
        // TODO add your handling code here:
        ccasw_FAX1 fax = new ccasw_FAX1();
        fax.setVisible(true);

        if(tabdet.getSelectedIndex()==0 && !txtcusfax.getText().equals("")){
            Fax.txtcto.setText(txtcusfax.getText());
        }
        if(tabdet.getSelectedIndex()==1 && !txtTowPho.getText().equals("")){
            Fax.txtcto.setText(txtTowPho.getText());
        }

        Fax.txtnotic.setText(txtnotic.getText());
        Fax.id=id;
        Fax.faxtic=true;
}//GEN-LAST:event_btnfaxActionPerformed

    private void btncallActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btncallActionPerformed
        // TODO add your handling code here:
        ccasw_OutBound out = new ccasw_OutBound();
        out.setVisible(true);

        if(tabdet.getSelectedIndex()==0){
            Obc.txtdial.setText(txtCellPho.getText());
        }
        if(tabdet.getSelectedIndex()==1){
            Obc.txtdial.setText(txtTowPho.getText());
        }
        Obc.txtnotic1.setText(String.valueOf(id));
        Obc.txtnotic.setText(txtnotic.getText());
        Obc.obtic=true;

        Obc.klik2();
}//GEN-LAST:event_btncallActionPerformed

    private void btnmailActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnmailActionPerformed
        // TODO add your handling code here:
        ccasw_EMail mail = new ccasw_EMail();
        mail.setVisible(true);

        if(tabdet.getSelectedIndex()==0){
            Mail.txtcto.setText(txtcusnam.getText());
        }
        if(tabdet.getSelectedIndex()==1){
            Mail.txtcto.setText(txtTowMail.getText());
        }
        Mail.txtnotic.setText(txtnotic.getText());
        Mail.id=id;
        Mail.mailtic=true;
    }//GEN-LAST:event_btnmailActionPerformed

    private void btncreateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btncreateActionPerformed
        // TODO add your handling code here:
        opdt();
        optm();
        if (txtcusnam.getText().equals("")){
            JOptionPane.showMessageDialog(null, "Customer Name cannot be empty !! Ticket Cannot be Created", "TICKETING",JOptionPane.WARNING_MESSAGE);
        }else{
            if(cksubmit.isSelected()==true){
                submit=1;
            }else{
                submit=0;
            }  
            if (newtic==true){
                System.out.print("\nnewtic=true "+newtic);
                if (inputValid()==true || txtcusnam.getText().equals("")){
                    getdept();getCatDetId();
                    if(CatDetId!=null){
                        getCatDetId1();
                    }
                    usrlvl();
                    try{
                    sql="insert into tickets (_status," +
                            "dept_id," +
                            "category_id," +
                            "category," +
                            "category_detail," +
                            "_type," +
                            "assign_dept," +
                            "_priority," +
                            "sla," +
                            "cust_code," +
                            "cust_name," +
                            "cust_address," +
                            "cust_phone," +
                            "cust_fax," +
                            "cust_pic," +
    //                        "contract_no, " +
                            "cso_code," +
                            "cso_name," +
                            "cso_phone," +
                            "cso_mail," +
                            "details," +
                            "note," +
                            "open_date," +
                            "open_time," +
                            "open_username," +
                            "open_dept," +
                            "_submitted" +
                            ")" +
                            " values (" +
                            "0" +
                            ",'"+deptid+"'" +
                            ",'"+cbCategory.getSelectedIndex()+"'" +
                            ",'"+cbCategory.getSelectedItem()+"'" +
                            ",'"+cbCatDetail.getSelectedItem()+"'" +
                            ",'"+cbTicketType.getSelectedItem()+"'" +
                            ",'"+deptid+"'" +
                            ",'"+cbprior.getSelectedIndex()+"'" +
                            ",'"+sla+"'" +
                            ",'"+txtNoPolis.getText()+"'" +
                            ",'"+txtcusnam.getText()+"'" +
                            ",'"+txtcustadd.getText()+"'" +
                            ",'"+txtcusfax.getText()+"'" +
                            ",'"+txtcusfax.getText()+"'" +
                            ",'"+txtEmail.getText()+"'" +
    //                        ",'"+txtcontract.getText()+"'" +
                            ",'"+txtTowCode.getText()+"'" +
                            ",'"+txtTowName.getText()+"'" +
                            ",'"+txtTowPho.getText()+"'" +
                            ",'"+txtTowMail.getText()+"'" +
                            ",'"+txtdetails.getText()+"'" +
                            ",'"+CCanj.lbluser.getText()+"@"+opdt.substring(8,10)+"/"+opdt.substring(5,7)+"/"+opdt.substring(0,4)+" "+optm.replace(':','.')+" : \nCategory : "+cbCategory.getSelectedItem()+"\nDetail Category : "+cbCatDetail.getSelectedItem()+"\n"+txtnote.getText()+"==='" +
                            ",'"+opdt+"'" +
                            ",'"+optm+"'" +
                            ",'"+CCanj.lbluser.getText()+"'" +
                            ",'"+Log.deptid+"'" +
                            ",'"+submit+"')";

                    sql="insert into tickets set dept_id="+deptid+", assign_dept="+deptid+", category_id="+cbCategory.getSelectedIndex()+"+1 "
                            + ", category_detail_id="+CatDetId+", category_subdetail_id="+CatDetId1+" "
                            + ", category_reason='"+cbCatDetail2.getSelectedItem()+"', product_id="+cbProd.getSelectedIndex()+""
                            + ", type_id='"+cbTicketType.getSelectedIndex()+"' "
                            + ", source_id='"+cbSourceTic.getSelectedIndex()+"',media_id='"+cbMediaTic.getSelectedIndex()+"'"
                            + ", _priority='"+cbprior.getSelectedIndex()+"' "
                            + ", sla='"+sla+"'"
                            + ", cust_id='"+txtNoPolis.getText()+"' ,cust_name='"+txtcusnam.getText()+"' "
                            + ", cust_gender='"+cbSex.getSelectedItem()+"', cust_mobile_phone='"+txtCellPho.getText()+"' "
                            + ", cust_work_phone='"+txtWorkPho.getText()+"', cust_fax='"+txtcusfax.getText()+"' "
                            + ", cust_email='"+txtEmail.getText()+"', cust_address='"+txtcustadd.getText()+"'"
                            + ", info='"+txtdetails.getText()+"', note='"+CCanj.lbluser.getText()+"@"+opdt.substring(8,10)+"/"+opdt.substring(5,7)+"/"+opdt.substring(0,4)+" "+optm.replace(':','.')+" : \nCategory : "+cbCategory.getSelectedItem()+"\nDetail Category : "+cbCatDetail.getSelectedItem()+"\n"+txtnote.getText()+"==='"
                            + ", open_date='"+opdt+"', open_time='"+optm+"'"
                            + ", open_username='"+CCanj.lbluser.getText()+"', open_dept='"+Log.deptid+"', _submitted='"+submit+"'";
                    CCanj.jconn.SQLExecute(sql,CCanj.conn);
                    sqlid="select distinct last_insert_id() from tickets";
                    rs=CCanj.jconn.SQLExecuteRS(sqlid, CCanj.conn);
                      while (rs.next()) {
                        id =Integer.parseInt(rs.getString(1));
                      }
                    
                    sqlco="select count(*) from tickets where year(open_date)=year(CURRENT_DATE) and month(open_date)=month(CURRENT_DATE) and ticket_id < '"+id+"'";
                    rs1=CCanj.jconn.SQLExecuteRS(sqlco,CCanj.conn);
                    while (rs1.next()) {
                        coun =Integer.parseInt(rs1.getString(1));
                    }
                    coun=coun+1;
                    System.out.print("\nisi no coun = "+coun+"\n");
                    sqlno="update tickets set ticket_no=concat(right(YEAR(CURRENT_DATE),2),lpad(Month(Current_date),2,'0'),lpad(day(Current_date),2,'0'),lpad('"+coun+"',4,'0')) where ticket_id='"+id+"'";
                    CCanj.jconn.SQLExecute(sqlno, CCanj.conn);
                    sqlno1="select ticket_no from tickets where ticket_id = '"+id+"'";
                    rs0=CCanj.jconn.SQLExecuteRS(sqlno1,CCanj.conn);
                    while (rs0.next()) {
                        no1 =Integer.parseInt(rs0.getString(1));
                    }
                    sql2="insert into log_tickets (log_date,log_time,username,user_level,ticket_id,_status,info,ticket_no) values ('"+opdt+"','"+optm+"','"+CCanj.lbluser.getText()+"','"+usrlvl+"','"+id+"',0,'TICKET OPENED \n\n Category : "+cbCategory.getSelectedItem()+"\nDetail Category : "+cbCatDetail.getSelectedItem()+"\n\n"+txtdetails.getText()+" \n\n "+txtnote.getText()+", "+rnarasi+"','"+no1+"')";
                    CCanj.jconn.SQLExecute(sql2,CCanj.conn);
                    if(submit==0){
//                        JOptionPane.showMessageDialog(null, "TICKET "+no1+" CREATED\n "+sql+"", "TICKETING",JOptionPane.WARNING_MESSAGE);
                        JOptionPane.showMessageDialog(null, "TICKET "+no1+" CREATED", "TICKETING",JOptionPane.WARNING_MESSAGE);
//                        if (cbDept.getSelectedItem().equals("DEPT. MARKETING")){
//                            sql1="insert into log_mail (mail_from,mail_to,mail_subject,mail_text,ticket_id,direction,username,direction_type) values ('contact@mpm-rent.com','"+txtTowMail.getText()+"','<Ticket>#"+txtcusnam.getText()+"#"+cbCategory.getSelectedItem()+"#"+no1+"','Details :\n"+txtdetails.getText()+"\n\nSoluiton :\n"+txtlastnote.getText()+" \n\n Action Status : "+rnarasi+"\n\n CREATED','"+id+"',1,'"+CCanj.lbluser.getText()+"','Internal-CSO')";
//                            CCanj.jconn.SQLExecute(sql1,CCanj.conn);
//                        }else{
//                            sql1="insert into log_mail (mail_from,mail_to,mail_subject,mail_text,ticket_id,direction,username,direction_type) values ('contact@mpm-rent.com','"+txtTowMail.getText()+"','<CC>#"+txtcusnam.getText()+"#"+cbCategory.getSelectedItem()+"#"+no1+"','Details :\n"+txtdetails.getText()+"\n\nSoluiton :\n"+txtlastnote.getText()+" \n\n Action Status : "+rnarasi+"\n\n CREATED','"+id+"',1,'"+CCanj.lbluser.getText()+"','Internal-CSO')";
//                            CCanj.jconn.SQLExecute(sql1,CCanj.conn);
//                        }
//                        JOptionPane.showMessageDialog(null, "EMAIL SENT", "MAILING",JOptionPane.WARNING_MESSAGE);
                    }else{
                        JOptionPane.showMessageDialog(null, "TICKET "+no1+" SUBMITED", "TICKETING",JOptionPane.WARNING_MESSAGE);
                        CCanj.s = "TICKET|ASSIGN|"+deptid+"|"+no1+"\r\n";
                        CCanj.kirimBroad();
                        sql1 = "insert into notify (ticket_id,username,_read) (select " + id + ",username,0 from user_account where dept_id in (" + deptid + "))";
                        CCanj.jconn.SQLExecute(sql1, CCanj.conn);
//                        if (cbDept.getSelectedItem().equals("DEPT. MARKETING")){
//                            sql1="insert into log_mail (mail_from,mail_to,mail_subject,mail_text,ticket_id,direction,username,direction_type) values ('contact@mpm-rent.com','"+txtTowMail.getText()+"','<Ticket>#"+txtcusnam.getText()+"#"+cbCategory.getSelectedItem()+"#"+no1+"','Details :\n"+txtdetails.getText()+"\n\nSoluiton :\n"+txtlastnote.getText()+" \n\n Action Status : "+rnarasi+"\n\n SUBMITED','"+id+"',1,'"+CCanj.lbluser.getText()+"','Internal-CSO')";
//                            CCanj.jconn.SQLExecute(sql1,CCanj.conn);
//                        }else{
//                            sql1="insert into log_mail (mail_from,mail_to,mail_subject,mail_text,ticket_id,direction,username,direction_type) values ('contact@mpm-rent.com','"+txtTowMail.getText()+"','<CC>#"+txtcusnam.getText()+"#"+cbCategory.getSelectedItem()+"#"+no1+"','Details :\n"+txtdetails.getText()+"\n\nSoluiton :\n"+txtlastnote.getText()+" \n\n Action Status : "+rnarasi+"\n\n SUBMITED','"+id+"',1,'"+CCanj.lbluser.getText()+"','Internal-CSO')";
//                            CCanj.jconn.SQLExecute(sql1,CCanj.conn);
//                        }
//                        JOptionPane.showMessageDialog(null, "EMAIL SENT", "MAILING",JOptionPane.WARNING_MESSAGE);
                    }

//                        bersih();
    //                    generateNoTrans();
        //            System.out.print(sql);
    //                if (cbdept.getSelectedItem().equals("DEPT. MARKETING")){
    //                    sql1="insert into log_mail (mail_from,mail_to,mail_subject,mail_text,ticket_id,direction,username) values ('faiz@jsm.co.id','"+txtcsomail.getText()+"','<Ticket>#"+txtcusnam.getText()+"#"+cbnoplat.getSelectedItem()+"#"+txtusr.getText()+"#"+cbcategory.getSelectedItem()+"#"+no1+"','"+txtdetails.getText()+"\n\n"+txtsolution.getText()+"','"+id+"',1,'"+CCanj.lbluser.getText()+"')";
    //                    jconn.SQLExecute(sql1,conn);
    //                }else{
    //                    sql1="insert into log_mail (mail_from,mail_to,mail_subject,mail_text,ticket_id,direction,username) values ('faiz@jsm.co.id','"+txtcsomail.getText()+"','<CC>#"+txtcusnam.getText()+"#"+cbnoplat.getSelectedItem()+"#"+txtusr.getText()+"#"+cbcategory.getSelectedItem()+"#"+no1+"','"+txtdetails.getText()+"','"+id+"',1,'"+CCanj.lbluser.getText()+")";
    //                    jconn.SQLExecute(sql1,conn);
    //                }
                    }catch(Exception e){
                        System.out.println(e);
                    }
                      CCanj.s = "MAIL|OUTBOUND\r\n";CCanj.kirimBroad();
//                            JOptionPane.showMessageDialog(null, "EMAIL SENT", "MAILING",JOptionPane.WARNING_MESSAGE);
                    newtic=false;
                }else{
                    JOptionPane.showMessageDialog(null,"Data Incomplete, Please fill it first , You cannot created ticket");
                }
            }else{
                System.out.print("\nnewtic = false = "+newtic);
                System.out.print("\nsubmit = 0 = "+ submit);
                    getdept();getCatDetId();
                    if(CatDetId!=null){
                        getCatDetId1();
                    }
                    usrlvl();
                    if(ass==-1){
                        ass=Integer.parseInt(deptid);
                    }
                    rnarasi="";
                    if(!strKategory.equals(cbCategory.getSelectedItem())){
                        rnarasi=rnarasi+"Change Category from "+strKategory+" to "+cbCategory.getSelectedItem()+" \n";
                    }
                    if(!strKategoryDetail.equals(cbCatDetail.getSelectedItem())){
                        rnarasi=rnarasi+"Change Category Detail from "+strKategoryDetail+" to "+cbCatDetail.getSelectedItem()+" \n";
                    }
                    if(cbCatDetail1.isEnabled()==true&&!strSubKategoryDetail.equals(cbCatDetail1.getSelectedItem())){
                        rnarasi=rnarasi+"Change Sub Category Detail from "+strSubKategoryDetail+" to "+cbCatDetail1.getSelectedItem()+" \n";
                    }
                    if(cbCatDetail2.isEnabled()==true&&!strKategoryReason.equals(cbCatDetail2.getSelectedItem())){
                        rnarasi=rnarasi+"Change Category Reason from "+strKategoryReason+" to "+cbCatDetail2.getSelectedItem()+" \n";
                    }
                    if(cbDept.getSelectedIndex()!=-1&&!strDepartment.equals(cbDept.getSelectedItem())){
                        rnarasi=rnarasi+"Change Department from "+strDepartment+" to "+cbDept.getSelectedItem()+" \n";
                    }
                    if(submit==1&&ass!=0){
                        rnarasi="Ticket submitted to "+cbDept.getSelectedItem()+" \n"+rnarasi;
                    }else{
                        rnarasi="Ticket update \n"+rnarasi;
                    }
                    sql="update tickets set dept_id="+deptid+", assign_dept="+deptid+", category_id="+cbCategory.getSelectedIndex()+"+1 "
                            + ", category_detail_id="+CatDetId+", category_subdetail_id="+CatDetId1+" "
                            + ", category_reason='"+cbCatDetail2.getSelectedItem()+"', product_id="+cbProd.getSelectedIndex()+""
                            + ", type_id='"+cbTicketType.getSelectedIndex()+"' "
                            + ", source_id='"+cbSourceTic.getSelectedIndex()+"',media_id='"+cbMediaTic.getSelectedIndex()+"'"
                            + ", _priority='"+cbprior.getSelectedIndex()+"' "
                            + ", sla='"+sla+"'"
                            + ", cust_id='"+txtNoPolis.getText()+"' ,cust_name='"+txtcusnam.getText()+"' "
                            + ", cust_gender='"+cbSex.getSelectedItem()+"', cust_mobile_phone='"+txtCellPho.getText()+"' "
                            + ", cust_work_phone='"+txtWorkPho.getText()+"', cust_fax='"+txtcusfax.getText()+"' "
                            + ", cust_email='"+txtEmail.getText()+"', cust_address='"+txtcustadd.getText()+"'"
//                            + ", cso_name='"+txtTowName.getText()+"' "
//                            + ", cso_phone='"+txtTowPho.getText()+"', cso_mail='"+txtTowMail.getText()+"'"
                            + ", info='"+txtdetails.getText()+"'" +
                            " ,note='"+CCanj.lbluser.getText()+"@"+opdt.substring(8,10)+"/"+opdt.substring(5,7)+"/"+opdt.substring(0,4)+" "+optm.replace(':','.')+" : \n\n"+rnarasi+"\n\n"+txtnote.getText()+"===\n"+txtlastnote.getText()+"'" +
                            " , _submitted='"+submit+"' where ticket_id='"+id+"'";
                    CCanj.jconn.SQLExecute(sql,CCanj.conn);
                    
                    if (statuss==0 && ass==0){
                        sql3="update tickets set _status=1, process_date='"+opdt+"', process_time='"+optm+"', process_username='"+CCanj.lbluser.getText()+"' where ticket_id='"+id+"' and ticket_no='"+txtnotic.getText()+"'";
                        CCanj.jconn.SQLExecute(sql3,CCanj.conn);
                        statuss=1;
                    }
                    if(submit==1){
                        JOptionPane.showMessageDialog(null, "TICKET "+txtnotic.getText()+" SUBMITED", "TICKETING",JOptionPane.WARNING_MESSAGE);
                        
                        sql1 = "insert into notify (ticket_id,username,_read) (select " + id + ",username,0 from user_account where dept_id in (" + deptid + "))";
                        ContactCenterASWATA.jconn.SQLExecute(sql1, ContactCenterASWATA.conn);
//                        if (cbDept.getSelectedItem().equals("DEPT. MARKETING")){
//                            sql1="insert into log_mail (mail_from,mail_to,mail_subject,mail_text,ticket_id,direction,username,direction_type) values ('contact@mpm-rent.com','"+txtTowMail.getText()+"','<Ticket>#"+txtcusnam.getText()+"#"+cbCategory.getSelectedItem()+"#"+txtnotic.getText()+"','Submitted by : "+CCanj.lbluser.getText()+"\n"+opdt+"\n"+optm+"\n\n"+txtdetails.getText()+"\n\n"+txtlastnote.getText()+"\n\n Action Status : "+rnarasi+"','"+id+"',1,'"+CCanj.lbluser.getText()+"','Internal-CSO')";
//                            System.out.print("\n isi sql insert mail "+sql1 );
//                            CCanj.jconn.SQLExecute(sql1,CCanj.conn);
//
//                        }else{
//                            sql1="insert into log_mail (mail_from,mail_to,mail_subject,mail_text,ticket_id,direction,username,direction_type) values ('contact@mpm-rent.com','"+txtTowMail.getText()+"','<CC>#"+txtcusnam.getText()+"#"+cbCategory.getSelectedItem()+"#"+txtnotic.getText()+"','Submitted by : "+CCanj.lbluser.getText()+"@"+opdt+"\n"+optm+"\n\n"+txtdetails.getText()+"\n\n"+txtlastnote.getText()+"\n\n Action Status : "+rnarasi+"','"+id+"',1,'"+CCanj.lbluser.getText()+"','Internal-CSO')";
//                            System.out.print("\n isi sql insert mail "+sql1 );
//                            CCanj.jconn.SQLExecute(sql1,CCanj.conn);
//
//                        }
//                        JOptionPane.showMessageDialog(null, "EMAIL SENT", "MAILING",JOptionPane.WARNING_MESSAGE);
    //                    System.out.print(sql1);
//                        connect();
                        CCanj.s = "TICKET|ASSIGN|"+deptid+"|"+txtnotic.getText()+"\r\n";
                        CCanj.kirimBroad();
                    }else{
                        JOptionPane.showMessageDialog(null, "TICKET UPDATED", "TICKETING",JOptionPane.WARNING_MESSAGE);
//                        if (cbDept.getSelectedItem().equals("DEPT. MARKETING")){
//                            sql1="insert into log_mail (mail_from,mail_to,mail_subject,mail_text,ticket_id,direction,username,direction_type) values ('contact@mpm-rent.com','"+txtTowMail.getText()+"','UPDATE<Ticket>#"+txtcusnam.getText()+"#"+cbCategory.getSelectedItem()+"#"+txtnotic.getText()+"','UPDATE by : "+CCanj.lbluser.getText()+"\n"+opdt+"\n"+optm+"\n\n"+txtdetails.getText()+"\n\n"+txtlastnote.getText()+"\n\n Action Status : "+rnarasi1+" Set to "+rnarasi+"','"+id+"',1,'"+CCanj.lbluser.getText()+"','Internal-CSO')";
//                            CCanj.jconn.SQLExecute(sql1,CCanj.conn);
//                        }else{
//                            sql1="insert into log_mail (mail_from,mail_to,mail_subject,mail_text,ticket_id,direction,username,direction_type) values ('contact@mpm-rent.com','"+txtTowMail.getText()+"','UPDATE<CC>#"+txtcusnam.getText()+"#"+cbCategory.getSelectedItem()+"#"+txtnotic.getText()+"','UPDATE by : "+CCanj.lbluser.getText()+"\n"+opdt+"\n"+optm+"\n\n"+txtdetails.getText()+"\n\n"+txtlastnote.getText()+"\n\n Action Status : "+rnarasi1+" Set to "+rnarasi+"','"+id+"',1,'"+CCanj.lbluser.getText()+"','Internal-CSO')";
//                            CCanj.jconn.SQLExecute(sql1,CCanj.conn);
//                        }
//                        JOptionPane.showMessageDialog(null, "EMAIL SENT", "MAILING",JOptionPane.WARNING_MESSAGE);
                        CCanj.s = "TICKET|UPDATE|"+deptid+"|"+txtnotic.getText()+"\r\n";
                        CCanj.kirimBroad();
    //                    System.out.print(sql1);
                    }
                    sql2="insert into log_tickets (log_date,log_time,username,user_level"
                            + ",ticket_id,info,ticket_no,_status)"
                            + " values"
                            + " ('"+opdt+"','"+optm+"','"+CCanj.lbluser.getText()+"','"+usrlvl+"'"
                            + ",'"+id+"','"+rnarasi+"\n "+txtnote.getText()+"','"+txtnotic.getText()+"','"+statuss+"')";
                    Log.jconn.SQLExecute(sql2,Log.conn);
                    CCanj.s = "TICKET|UPDATE|"+deptid+"|"+txtnotic.getText()+"\r\n";
                    CCanj.kirimBroad();

                System.out.print("\nsubmit = 1 = "+ submit);

            }//end of validasi newticket
        }//end of validasi txtcso

        if(caltic==true){
            Obc.txtnotic1.setText(Integer.toString(no1));
        }
        dispose();
    }//GEN-LAST:event_btncreateActionPerformed

    private void btnclosedActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnclosedActionPerformed
        // TODO add your handling code here:
        ccasw_Closed_tic clo= new ccasw_Closed_tic();
        clo.setVisible(true);
    }//GEN-LAST:event_btnclosedActionPerformed

    private void btnReOpenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnReOpenActionPerformed
        // TODO add your handling code here:
        opdt();
        optm();
        int i=JOptionPane.showConfirmDialog(null, "You will re-open this Ticket..!!!??","SAVE",JOptionPane.YES_NO_OPTION);
        if (i==JOptionPane.YES_OPTION){
            sql="update tickets set _status=5, re_open_date='"+opdt+"', re_open_time='"+optm+"', re_open_username='"+CCanj.lbluser.getText()+"', re_open_counter=re_open_counter+1"
                    + ", note='ticket Re-Opened by : "+CCanj.lbluser.getText()+"@"+opdt.substring(8, 10) + "/" + opdt.substring(5, 7) + "/" + opdt.substring(0, 4)+" "+optm.replaceAll(":",".")+"\n\n"+txtdetails.getText()+"\n\n"+txtnote.getText()+"\n\n"+txtlastnote.getText()+"'"
                    + " where ticket_id='"+id+"'";
            CCanj.jconn.SQLExecute(sql,CCanj.conn);
            sql2="insert into log_tickets"
                    + " (log_date,log_time,username,user_level,ticket_id,ticket_no,_status,info)"
                    + " values ('"+opdt+"','"+optm+"','"+CCanj.lbluser.getText()+"','"+usrlvl+"','"+id+"','"+txtnotic.getText()+"',5,'ticket Re-Opened by : "+CCanj.lbluser.getText()+"@"+opdt.substring(8, 10) + "/" + opdt.substring(5, 7) + "/" + opdt.substring(0, 4)+" "+optm.replaceAll(":",".")+"\n\n"+txtnote.getText()+"')";
            CCanj.jconn.SQLExecute(sql2,CCanj.conn);
        }
        btnReOpen.setEnabled(false);
        dispose();
        CCanj.tabeltic();
    }//GEN-LAST:event_btnReOpenActionPerformed

    private void btnsmsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsmsActionPerformed
        // TODO add your handling code here:
        ccasw_SMS sms = new ccasw_SMS();
        sms.setVisible(true);

        if(tabdet.getSelectedIndex()==0){
            Sms.txtto.setText(txtCellPho.getText());
        }
        if(tabdet.getSelectedIndex()==1){
            Sms.txtto.setText(txtTowPho.getText());
        }
        Sms.txtnotic.setText(txtnotic.getText());
        Sms.id=id;
        Sms.smstic=true;
}//GEN-LAST:event_btnsmsActionPerformed

    private void cbDeptActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbDeptActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cbDeptActionPerformed

    public boolean catdetailupadate=false;
    public boolean catfinalupadate=false;
    private void btnsrchcusActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsrchcusActionPerformed
        // TODO add your handling code here:
        ccasw_Search_customer srcus = new ccasw_Search_customer();
        srcus.setVisible(true);
        srcus.Form = 1;
    }//GEN-LAST:event_btnsrchcusActionPerformed

    private void cbCatDetailActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbCatDetailActionPerformed
        // TODO add your handling code here:
        if(raction3==true){
            getCatDetId();
            showSubDetailCategory();
        }
    }//GEN-LAST:event_cbCatDetailActionPerformed

    private void cbProdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbProdActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cbProdActionPerformed

    private void cbCatDetail1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbCatDetail1ActionPerformed
        // TODO add your handling code here:
        if(raction1==true){
            getCatDetId1();
            showSubDetailCategory1();
        }
    }//GEN-LAST:event_cbCatDetail1ActionPerformed

    private void btnresetActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnresetActionPerformed
        // TODO add your handling code here:
        showDept();showProd();
        showCategory();
        cbCatDetail.removeAllItems();
        cbCatDetail1.removeAllItems();        cbCatDetail2.removeAllItems();
        cbCatDetail1.setEnabled(false);        cbCatDetail2.setEnabled(false);
        showType();showMedia();showSource();
    }//GEN-LAST:event_btnresetActionPerformed

    private void btnhistActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnhistActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnhistActionPerformed

    private void btnsrch3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsrch3ActionPerformed
        // TODO add your handling code here:
        ccasw_Search_Policy srpolis = new ccasw_Search_Policy();
        srpolis.setVisible(true);
        srpolis.Form = 1;
        srpolis.txtDocNo.setText(txtNoPolis.getText());
        srpolis.btnsrch.setEnabled(true);
    }//GEN-LAST:event_btnsrch3ActionPerformed

    private void btnsrch1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsrch1ActionPerformed
        // TODO add your handling code here:
        //        try {
        ccasw_Search_Claim srclaim = new ccasw_Search_Claim();
        srclaim.setVisible(true);
        srclaim.Form = 1;
        srclaim.txtNama.setText(txtClaimNo.getText());
        srclaim.btnsrch.setEnabled(true);
        //            sql1 = "insert into ws_request set"
        //                    + " request_time=CURRENT_TIMESTAMP "
        //                    + ",username='" + CCanj.lbluser.getText() + "'"+ ",function_id=9"
        //                    + ",ws_params='" + srclaim.txtBranch.getText() + "|" + srclaim.txtCoB.getText() + "|" + srclaim.txtNama.getText() + "|" + srclaim.txtReportBy.getText() + "|" + srclaim.txtSttClaim.getText() + ""
        //                    + "|||||" + srclaim.txtRegNo.getText() + "|" + srclaim.txtPolicyNo.getText() + "'"+ "";
        //            CCanj.jconn.SQLExecute(sql1, CCanj.conn);
        //            sqlid = "select distinct last_insert_id() from ws_request";
        //            rs = CCanj.jconn.SQLExecuteRS(sqlid, CCanj.conn);
        //            while (rs.next()) {
        //                srclaim.wsid = Integer.parseInt(rs.getString(1));
        //                srclaim.ws = true;
        //            }
        //            System.out.println("\n wsid dr inb : "+srclaim.wsid);
        //            srclaim.request();
        //        } catch (SQLException ex) {
        //            Logger.getLogger(ccasw_InBoundCall.class.getName()).log(Level.SEVERE, null, ex);
        //        }
}//GEN-LAST:event_btnsrch1ActionPerformed

    private void btnViewPolisActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnViewPolisActionPerformed
        // TODO add your handling code here:
        int wsid1=-1;boolean ws1=false;
        try{
            sql1 = "insert into ws_request set request_time=CURRENT_TIMESTAMP "
                    + ",username='" + CCanj.lbluser.getText() + "'"
                    + ",function_id=8"
                    + ",ws_params='"+txtNoPolis.getText()+".'"
                    + "";
            CCanj.jconn.SQLExecute(sql1, CCanj.conn);
            sqlid = "select distinct last_insert_id() from ws_request";
            rs = CCanj.jconn.SQLExecuteRS(sqlid, CCanj.conn);
            while (rs.next()) {
                wsid1 = Integer.parseInt(rs.getString(1));
                ws1 = true;
            }
            System.out.println("\n wsid1 : "+wsid1);

            ccasw_View_Policy VIPO=new ccasw_View_Policy();
            VIPO.setVisible(true);
            if(ws1=true){
                VIPO.ws=ws1;
                VIPO.wsid=wsid1;
                VIPO.request();
            }
        }catch (SQLException ex) {
            Logger.getLogger(ccasw_Search_customer.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnViewPolisActionPerformed

    private void btnViewClaimActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnViewClaimActionPerformed
        // TODO add your handling code here:
        int wsid1 = -1; boolean ws1 = false;
        try {
            sql1 = "insert into ws_request set request_time=CURRENT_TIMESTAMP ,username='" + ContactCenterASWATA.lbluser.getText() + "'" + ",function_id=10" + ",ws_params='" + txtClaimNo.getText() + ".'" + "";
            
            ContactCenterASWATA.jconn.SQLExecute(sql1, ContactCenterASWATA.conn);
            sqlid = "select distinct last_insert_id() from ws_request";
            rs = ContactCenterASWATA.jconn.SQLExecuteRS(sqlid, ContactCenterASWATA.conn);
            while (rs.next()) {
                wsid1 = Integer.parseInt(rs.getString(1));
                ws1 = true;
                
            }
            System.out.println("\n wsid1 : " + wsid1);
            
            ccasw_claim_registration CLREG = new ccasw_claim_registration();
            CLREG.setVisible(true);
            CLREG.wsid = wsid1;
            CLREG.Form = 1;
            CLREG.btnClaimSave.setEnabled(false);
            if (ws1 ==true)  {
                CLREG.ws1 = true;
                CLREG.wsid = wsid1;
                CLREG.request();
            }
        } catch (SQLException ex) {
            Logger.getLogger(ccasw_Search_customer.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnViewClaimActionPerformed

    private void txtNoPolisCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_txtNoPolisCaretUpdate
        // TODO add your handling code here:
        if(txtNoPolis.getText().length()<20){
            btnViewPolis.setEnabled(false);
        }else{
            btnViewPolis.setEnabled(true);
        }
    }//GEN-LAST:event_txtNoPolisCaretUpdate

    private void txtClaimNoCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_txtClaimNoCaretUpdate
        // TODO add your handling code here:
        if (txtClaimNo.getText().length() < 20)
            btnViewClaim.setEnabled(false);
        else
            btnViewClaim.setEnabled(true);
    }//GEN-LAST:event_txtClaimNoCaretUpdate


     private boolean inputValid(){
        boolean result;
        if((cbCategory.getSelectedItem().equals("NON CUSTOMER"))){
            result=true;
        }else{
            if((cbCategory.getSelectedIndex()==-1)||(cbDept.getSelectedIndex()==-1)||(cbSourceTic.getSelectedIndex()==-1)
                    ||(cbTicketType.getSelectedIndex()==-1)||(cbCatDetail.getSelectedIndex()==-1)||(cbProd.getSelectedIndex()==-1)){
                JOptionPane.showMessageDialog(null,"Fill All mandatory feild first \nwich has stars mark(*)");
                result=false;
            }else
                result=true;
            }
        return result;
    }
    /**
    * @param args the command line arguments
    */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new ccasw_ticket().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    public static javax.swing.JButton btnReOpen;
    private javax.swing.JButton btnViewClaim;
    private javax.swing.JButton btnViewPolis;
    public static javax.swing.JButton btncall;
    private javax.swing.JButton btncanc;
    public static javax.swing.JButton btnclosed;
    public static javax.swing.JButton btncreate;
    public static javax.swing.JButton btnfax;
    private javax.swing.JButton btnhist;
    private javax.swing.JButton btnhist1;
    public static javax.swing.JButton btnmail;
    private javax.swing.JButton btnreset;
    public static javax.swing.JButton btnsms;
    private javax.swing.JButton btnsrch1;
    private javax.swing.JButton btnsrch3;
    private javax.swing.JButton btnsrchcus;
    public static javax.swing.JComboBox cbCatDetail;
    public static javax.swing.JComboBox cbCatDetail1;
    public static javax.swing.JComboBox cbCatDetail2;
    public static javax.swing.JComboBox cbCategory;
    public static javax.swing.JComboBox cbDept;
    public static javax.swing.JComboBox cbMediaTic;
    public static javax.swing.JComboBox cbProd;
    public static javax.swing.JComboBox cbSex;
    public static javax.swing.JComboBox cbSourceTic;
    public static javax.swing.JComboBox cbTicketType;
    public static javax.swing.JComboBox cbprior;
    public static javax.swing.JCheckBox cksubmit;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel35;
    private javax.swing.JLabel jLabel36;
    private javax.swing.JLabel jLabel37;
    private javax.swing.JLabel jLabel38;
    private javax.swing.JLabel jLabel39;
    private javax.swing.JLabel jLabel40;
    private javax.swing.JLabel jLabel41;
    private javax.swing.JLabel jLabel42;
    private javax.swing.JLabel jLabel43;
    private javax.swing.JLabel jLabel44;
    private javax.swing.JLabel jLabel45;
    private javax.swing.JLabel jLabel46;
    private javax.swing.JLabel jLabel47;
    private javax.swing.JLabel jLabel48;
    private javax.swing.JLabel jLabel49;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel51;
    private javax.swing.JLabel jLabel52;
    private javax.swing.JLabel jLabel53;
    private javax.swing.JLabel jLabel54;
    private javax.swing.JLabel jLabel56;
    private javax.swing.JLabel jLabel57;
    private javax.swing.JLabel jLabel58;
    private javax.swing.JLabel jLabel59;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel81;
    private javax.swing.JLabel jLabel82;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane11;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JTabbedPane jTabbedPane1;
    public static javax.swing.JTabbedPane tabdet;
    public static javax.swing.JTextField txtCellPho;
    public static javax.swing.JTextField txtClaimNo;
    public static javax.swing.JTextField txtEmail;
    public static javax.swing.JTextField txtFire1;
    public static javax.swing.JTextField txtFire2;
    public static javax.swing.JTextField txtMV1;
    public static javax.swing.JTextField txtMV2;
    public static javax.swing.JTextField txtMV3;
    public static javax.swing.JTextField txtMV4;
    public static javax.swing.JTextField txtMV5;
    public static javax.swing.JTextField txtMV6;
    public static javax.swing.JTextField txtMV7;
    public static javax.swing.JTextField txtNoPolis;
    public static javax.swing.JTextField txtTowCode;
    public static javax.swing.JTextField txtTowMail;
    public static javax.swing.JTextField txtTowName;
    public static javax.swing.JTextField txtTowPho;
    public static javax.swing.JTextField txtWorkPho;
    public static javax.swing.JTextField txtcso3;
    public static javax.swing.JTextField txtcso4;
    public static javax.swing.JTextField txtcsocode3;
    public static javax.swing.JTextField txtcsocode4;
    public static javax.swing.JTextField txtcsomail10;
    public static javax.swing.JTextField txtcsomail11;
    public static javax.swing.JTextField txtcsomail12;
    public static javax.swing.JTextField txtcsomail13;
    public static javax.swing.JTextField txtcsomail14;
    public static javax.swing.JTextField txtcsomail2;
    public static javax.swing.JTextField txtcsomail3;
    public static javax.swing.JTextField txtcsomail4;
    public static javax.swing.JTextField txtcsomail8;
    public static javax.swing.JTextField txtcsomail9;
    public static javax.swing.JTextField txtcsopho2;
    public static javax.swing.JTextField txtcsopho3;
    public static javax.swing.JTextField txtcsopho4;
    public static javax.swing.JTextField txtcsopho5;
    public static javax.swing.JTextField txtcsopho6;
    public static javax.swing.JTextField txtcusfax;
    public static javax.swing.JTextField txtcusnam;
    public static javax.swing.JTextArea txtcustadd;
    public static javax.swing.JTextArea txtdetails;
    public static javax.swing.JTextArea txtlastnote;
    public static javax.swing.JTextArea txtnote;
    public static javax.swing.JTextField txtnotic;
    // End of variables declaration//GEN-END:variables

    public static String sql;
    public static String sql1;
    public static String sql2;
    public static String sql3;
    public static String sqlid;
    public static String sqlco;
    public static String sqlno;
    public static String sqlno1;
    public static ResultSet rs0;
    public static ResultSet rs;
    public static ResultSet rs1;
//    public static JavaConnector jconn=new JavaConnector();
//    public static Connection conn;
    public static String ticid;

    public static void klik(){
        raction=false;        raction1=false;        raction2=false;        raction3=false;
        if ((id==0)){
            System.out.println("ififififif");
            System.out.println(id);
        }else{
            try{
                sql="select * "
                        + ", _sendertype.data as source"
                        + ", _ticketmedia.data as media"
                        + ", _inboundtype.data as _type"
                        + ", _ticketcategory.category_name as category"
                        + ", _ticketdetailcategory.detail_category_name as category_detail"
                        + ", _ticketdetailsubcategory.detail_sub_category_name as category_subdetail"
                        + ", _department.dept_name as dept_name"
                        + ", _ticketpriority.data as prior"
                        + ", _ticketstatus.data as stt"
                        + ", _relatedproduct.data as prod"
                        + " from tickets "
                        + " left join _sendertype on tickets.source_id=_sendertype.code"
                        + " left join _ticketmedia on tickets.media_id=_ticketmedia.code"
                        + " left join _inboundtype on tickets.type_id=_inboundtype.code"
                        + " left join _ticketcategory on tickets.category_id =_ticketcategory.category_id"
                        + " left join _ticketdetailcategory on tickets.category_detail_id =_ticketdetailcategory.detail_category_id"
                        + " left join _ticketdetailsubcategory on tickets.category_subdetail_id =_ticketdetailsubcategory.detail_sub_category_id"
                        + " left join _department on tickets.dept_id =_department.dept_id"
                        + " left join _ticketpriority on tickets._priority =_ticketpriority.code"
                        + " left join _ticketstatus on tickets._status =_ticketstatus.code"
                        + " left join _relatedproduct on tickets.product_id =_relatedproduct.code"
                        + " "
                        + " where ticket_id='"+id+"'";
                rs0=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
    //                 System.out.println(sql);
                while(rs0.next()){
    //                txtnotic.setText(rs.getString(1));
                    cbSourceTic.setSelectedIndex(Integer.parseInt(rs0.getString("source_id")));
                    cbMediaTic.setSelectedItem(rs0.getString("media"));
                    cbCategory.setSelectedItem(rs0.getString("category"));raction=true;
                    strKategory=(rs0.getString("category"));
                    cbCatDetail.addItem(rs0.getString("category_detail"));raction3=true;
                    strKategoryDetail=(rs0.getString("category_detail"));
                    cbCatDetail1.addItem(rs0.getString("category_subdetail"));raction1=true;
                    strSubKategoryDetail=(rs0.getString("category_subdetail"));
                    cbCatDetail2.addItem(rs0.getString("category_reason"));raction2=true;
                    strKategoryReason=(rs0.getString("category_reason"));
                    cbTicketType.setSelectedItem(rs0.getString("_type"));
                    cbprior.setSelectedIndex(Integer.parseInt(rs0.getString("_priority")));
                    cbProd.setSelectedItem(rs0.getString("prod"));
                    cbDept.setSelectedItem(rs0.getString("dept_name"));
                    strDepartment=(rs0.getString("dept_name"));
                    txtNoPolis.setText(rs0.getString("cust_id"));
                    txtcusnam.setText(rs0.getString("cust_name"));
                    cbSex.setSelectedItem(rs0.getString("cust_gender"));
                    txtcusfax.setText(rs0.getString("cust_fax"));
                    txtCellPho.setText(rs0.getString("cust_mobile_phone"));
                    txtEmail.setText(rs0.getString("cust_email"));
                    txtWorkPho.setText(rs0.getString("cust_work_phone"));
                    txtcustadd.setText(rs0.getString("cust_address"));
                    txtdetails.setText(rs0.getString("info"));
                    submit=Integer.parseInt(rs0.getString("_submitted"));
    //                txtlastnote.setText(rs.getString("solution"));
                    statuss=Integer.parseInt(rs0.getString("_status"));                    
                    txtlastnote.setText(rs0.getString("note"));
                    note=(String)rs0.getString("note");
                    ass=Integer.parseInt(rs0.getString("assign_dept"));
    //            System.out.println("jalan klik 2");
                    
                }
            }catch(Exception e){
                System.out.println(e);

            }
                 }
         if(submit==1){
              cksubmit.setSelected(true);
              cksubmit.setEnabled(false);
              if(cbprior.getSelectedIndex()==0){
                  btncreate.setEnabled(true);
                  btncreate.setText("Update");
              }else{
                  btncreate.setEnabled(false);
                  btncreate.setText("Submitted");
              }
              if(ass==0){
                  btncreate.setEnabled(true);
                  btncreate.setText("Save");
              }
         }else{
              cksubmit.setSelected(false);
              btncreate.setText("Save");
         }

         if(newtic==false && CCanj.cbdirection.getSelectedItem().equals("OUTBOUND") && CCanj.btnready.getText().equals("Unregis")){
            btncall.setEnabled(true);
            btnfax.setEnabled(true);
            btnmail.setEnabled(true);
            btnsms.setEnabled(true);
         }
        if(statuss==4){
            btnReOpen.setEnabled(true);
        }
     }

     public static void showcus(){
         try{
             sql="select * from customer_order where rec_id='"+contid+"' and contract_no='"+txtNoPolis.getText()+"'";
             rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
             while(rs.next()){
                txtNoPolis.setText(rs.getString("cust_code"));
                txtcusnam.setText(rs.getString("cust_name"));
                txtcusfax.setText(rs.getString("cust_fax"));
                txtCellPho.setText(rs.getString("cust_phone"));
                txtEmail.setText(rs.getString("pic_name"));
                txtNoPolis.setText(rs.getString("contract_no"));
                txtcustadd.setText(rs.getString("cust_addr"));
                txtTowCode.setText(rs.getString("cso_code"));
                txtTowName.setText(rs.getString("cso_name"));
                txtTowPho.setText(rs.getString("cso_phone"));
                txtTowMail.setText(rs.getString("cso_email"));
             }
                 if(txtTowMail.getText().equals("")){
                    System.out.print("klo mail cso kosong\n");
                    sql1 = "select email, phone_no from contact where code='" + txtTowCode.getText() + "'";
                    rs1 = CCanj.jconn.SQLExecuteRS(sql1, CCanj.conn);
                    System.out.print(sql1);
                    while (rs1.next()) {
                        System.out.print("\nisi mail "+rs1.getString("email"));
                        System.out.print("\nisi phone no "+rs1.getString("phone_no"));
                        txtTowPho.setText(rs1.getString("phone_no"));
                        txtTowMail.setText(rs1.getString("email"));
                    }
                }
         }catch(Exception e){
             System.out.println(e);
         }
     }
     private void showProd()    {
         try{
             cbProd.removeAllItems();
             sql="select data from _relatedproduct order by code";
             rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
             while(rs.next()){
                 cbProd.addItem(rs.getString(1));
             }
             cbProd.setSelectedIndex(-1);
         }catch(Exception e){
             System.out.println(e);
         }
     }
     private void showDept()    {
         try{
             cbDept.removeAllItems();
             sql="select dept_name from _department order by dept_id";
             rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
             while(rs.next()){
                 cbDept.addItem(rs.getString(1));
             }
             cbDept.setSelectedIndex(-1);
         }catch(Exception e){
             System.out.println(e);
         }
     }
     private void showSource(){
          cbSourceTic.removeAllItems();
          try{
              sql="select data from _sendertype order by code";
              rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
              while(rs.next()){
                  cbSourceTic.addItem(rs.getString(1));
              }
              cbSourceTic.setSelectedIndex(-1);
          }catch(Exception e){
              System.out.println(e);
          }
      }
     private void showMedia(){
          cbMediaTic.removeAllItems();
          try{
              sql="select data from _ticketmedia order by code";
              rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
              while(rs.next()){
                  cbMediaTic.addItem(rs.getString(1));
              }
//              cbMediaTic.setSelectedIndex(-1);
          }catch(Exception e){
              System.out.println(e);
          }
      }
      private void showType(){
          cbTicketType.removeAllItems();
          try{
              sql="select data from _inboundtype order by code";
              rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
              while(rs.next()){
                  cbTicketType.addItem(rs.getString(1));
              }
              cbTicketType.setSelectedIndex(-1);
          }catch(Exception e){
              System.out.println(e);
          }
      }
      private void showCategory(){
          raction=false;
          cbCategory.removeAllItems();
          try{
              sql="select category_name from _ticketcategory order by category_id";
              rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
              while(rs.next()){
                  cbCategory.addItem(rs.getString(1));
              }
              cbCategory.setSelectedIndex(-1);
              raction=true;
          }catch(Exception e){
              System.out.println(e);
          }
      }
      private void showDetailCategory(){
          raction3=false;
          cbCatDetail.removeAllItems();
          try{
              sql="select detail_category_name,sla from _ticketdetailcategory where category_id="+cbCategory.getSelectedIndex()+"+1 order by detail_category_id";
              rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
              while(rs.next()){
                  cbCatDetail.addItem(rs.getString(1));
                  sla=Integer.parseInt(rs.getString(2));
              }
              cbCatDetail.setSelectedIndex(-1);
              raction3=true;
          }catch(Exception e){
              System.out.println(e);
          }
      }
      private void showSubDetailCategory(){
          raction1=false;
          cbCatDetail1.removeAllItems();
          try{
              sql="select detail_sub_category_name from _ticketdetailsubcategory where detail_category_id="+CatDetId+" order by detail_sub_category_id";
              rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);              System.out.println("\nsql : "+sql);
              while(rs.next()){
                  cbCatDetail1.addItem(rs.getString(1));
              }
              cbCatDetail1.setSelectedIndex(-1);
              if(cbCatDetail1.getItemCount()!=0)
                  cbCatDetail1.setEnabled(true);
              else
                  cbCatDetail1.setEnabled(false);
              raction1=true;
          }catch(Exception e){
              System.out.println(e);
          }
      }
      private void showSubDetailCategory1(){
          raction2=false;
          cbCatDetail2.removeAllItems();
          try{
              sql="select reason from _ticketcategoryreason where detail_sub_category_id="+CatDetId1+" order by category_reason_id";
              rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);System.out.println("\nsql : "+sql);
              while(rs.next()){
                  cbCatDetail2.addItem(rs.getString(1));
              }
              cbCatDetail2.setSelectedIndex(-1);
              if(cbCatDetail2.getItemCount()!=0)
                  cbCatDetail2.setEnabled(true);
              else
                  cbCatDetail2.setEnabled(false);
              raction2=true;
          }catch(Exception e){
              System.out.println(e);
          }
      }

      private void getdetiltic(){
           try{
               sql="select question from _ticketcategory where category_id="+cbCategory.getSelectedIndex()+"+1 ";
               rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
               while(rs.next()){
                   txtdetails.setText(rs.getString(1));
               }
           }catch(Exception e){
               System.out.print(e);
           }
       }

      private void getdept(){
           try{
               sql="select dept_id from _department where dept_name='"+cbDept.getSelectedItem()+"'";
               rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
               while(rs.next()){
                   deptid=rs.getString(1);
               }
           }catch(Exception e){
               System.out.print(e);
           }
       }

       private void getCatDetId(){
           try{
               sql="select detail_category_id,sla,note from _ticketdetailcategory where detail_category_name='"+cbCatDetail.getSelectedItem()+"' and category_id="+cbCategory.getSelectedIndex()+"+1 and _deleted=0";
               rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
               while(rs.next()){
                   CatDetId=rs.getString(1);
                   sla=Integer.parseInt(rs.getString(2));
                   if(newtic==true){txtdetails.setText(rs.getString(3));}
               }
           }catch(Exception e){
               System.out.print(e);
           }
       }
       private void getCatDetId1(){
           try{
               sql="select detail_sub_category_id from _ticketdetailsubcategory where detail_sub_category_name='"+cbCatDetail1.getSelectedItem()+"' and detail_category_id='"+CatDetId+"' and _deleted=0";
               rs=CCanj.jconn.SQLExecuteRS(sql,CCanj.conn);
               while(rs.next()){
                   CatDetId1=rs.getString(1);
               }
           }catch(Exception e){
               System.out.print(e);
           }
       }

        private void usrlvl(){
            try{
                sql="select _level from user_account where username='"+CCanj.lbluser.getText()+"'";
                rs=CCanj.jconn.SQLExecuteRS(sql, CCanj.conn);
                while(rs.next()){
                    usrlvl=rs.getString(1);
                }
            }catch(Exception e){
                System.out.print(e);
            }
        }

         

    void bersih(){
        txtnotic.setText("");
        cbCategory.setSelectedItem("--");
        cbprior.setSelectedItem("NORMAL");
        cbDept.setSelectedItem("--");
//                cbasdept.setSelectedItem(rs.getString(5));
        txtcusnam.setText("");
        txtcusfax.setText("");
        txtEmail.setText("");
//                txtpicpho.setText(rs.getString(16));
        txtTowName.setText("");
        txtTowPho.setText("");
        txtdetails.setText("");
    }


    private void opdt(){
          try{
              sql="select CURRENT_DATE";
              rs = CCanj.jconn.SQLExecuteRS(sql, CCanj.conn);
              while(rs.next()){
                  opdt=rs.getString(1);
              }
          }catch(Exception exc){
              System.err.println(exc.getMessage());
          }
    }

        private void optm(){
            try{
              sql="select CURRENT_TIME";
              rs = CCanj.jconn.SQLExecuteRS(sql, CCanj.conn);
              while(rs.next()){
                  optm=rs.getString(1);
              }
          }catch(Exception exc){
              System.err.println(exc.getMessage());
          }
        }

}
